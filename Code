{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "63c0febd-4591-431f-97cf-e75ca01fbda5",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "from imblearn.under_sampling import RandomUnderSampler\n",
    "from sklearn.model_selection import train_test_split\n",
    "import seaborn as sns \n",
    "\n",
    "# para nuestro modelo \n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.linear_model import Lasso \n",
    "from sklearn.pipeline import Pipeline\n",
    "from sklearn.metrics import r2_score\n",
    "\n",
    "# para ingenieria de caracteristicas \n",
    "from sklearn.preprocessing import StandardScaler\n",
    "from feature_engine.encoding import CountFrequencyEncoder, OrdinalEncoder, RareLabelEncoder\n",
    "from feature_engine import imputation as mdi # missing data imputation\n",
    "from feature_engine.discretisation import EqualFrequencyDiscretiser"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "d9042591-00b1-40a9-a2a5-eed7d8979dff",
   "metadata": {},
   "outputs": [],
   "source": [
    "from feature_engine import encoding as menc\n",
    "from sklearn.preprocessing import RobustScaler, OrdinalEncoder\n",
    "from sklearn import preprocessing\n",
    "from sklearn.tree import DecisionTreeClassifier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "3a566a66-9ec7-4df7-aed2-11070d908bd7",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.linear_model import LogisticRegression"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "4512fd47-67a9-45e9-9a79-628b47cd6d3c",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.neighbors import KNeighborsClassifier\n",
    "from sklearn.model_selection import GridSearchCV\n",
    "from sklearn.metrics import accuracy_score\n",
    "from sklearn.preprocessing import OneHotEncoder\n",
    "from sklearn.ensemble import RandomForestClassifier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "74a43199-c318-4350-be5d-854974d496c5",
   "metadata": {},
   "outputs": [],
   "source": [
    "rus=RandomUnderSampler()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "fdf98f43-051a-4f4c-bbfb-fd5021c99a7c",
   "metadata": {},
   "outputs": [],
   "source": [
    "df = pd.read_csv('../z_train.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "393c7ff2-c629-40bf-8123-2d8ef3113bb3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>enrollee_id</th>\n",
       "      <th>city</th>\n",
       "      <th>city_development_index</th>\n",
       "      <th>gender</th>\n",
       "      <th>relevent_experience</th>\n",
       "      <th>enrolled_university</th>\n",
       "      <th>education_level</th>\n",
       "      <th>major_discipline</th>\n",
       "      <th>experience</th>\n",
       "      <th>company_size</th>\n",
       "      <th>company_type</th>\n",
       "      <th>last_new_job</th>\n",
       "      <th>training_hours</th>\n",
       "      <th>target</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>8949</td>\n",
       "      <td>city_103</td>\n",
       "      <td>0.920</td>\n",
       "      <td>Male</td>\n",
       "      <td>Has relevent experience</td>\n",
       "      <td>no_enrollment</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>STEM</td>\n",
       "      <td>&gt;20</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>36</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>29725</td>\n",
       "      <td>city_40</td>\n",
       "      <td>0.776</td>\n",
       "      <td>Male</td>\n",
       "      <td>No relevent experience</td>\n",
       "      <td>no_enrollment</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>STEM</td>\n",
       "      <td>15</td>\n",
       "      <td>50-99</td>\n",
       "      <td>Pvt Ltd</td>\n",
       "      <td>&gt;4</td>\n",
       "      <td>47</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>11561</td>\n",
       "      <td>city_21</td>\n",
       "      <td>0.624</td>\n",
       "      <td>NaN</td>\n",
       "      <td>No relevent experience</td>\n",
       "      <td>Full time course</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>STEM</td>\n",
       "      <td>5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>never</td>\n",
       "      <td>83</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>33241</td>\n",
       "      <td>city_115</td>\n",
       "      <td>0.789</td>\n",
       "      <td>NaN</td>\n",
       "      <td>No relevent experience</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>Business Degree</td>\n",
       "      <td>&lt;1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Pvt Ltd</td>\n",
       "      <td>never</td>\n",
       "      <td>52</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>21651</td>\n",
       "      <td>city_176</td>\n",
       "      <td>0.764</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Has relevent experience</td>\n",
       "      <td>Part time course</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>STEM</td>\n",
       "      <td>11</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>24</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   enrollee_id      city  city_development_index gender  \\\n",
       "0         8949  city_103                   0.920   Male   \n",
       "1        29725   city_40                   0.776   Male   \n",
       "2        11561   city_21                   0.624    NaN   \n",
       "3        33241  city_115                   0.789    NaN   \n",
       "4        21651  city_176                   0.764    NaN   \n",
       "\n",
       "       relevent_experience enrolled_university education_level  \\\n",
       "0  Has relevent experience       no_enrollment        Graduate   \n",
       "1   No relevent experience       no_enrollment        Graduate   \n",
       "2   No relevent experience    Full time course        Graduate   \n",
       "3   No relevent experience                 NaN        Graduate   \n",
       "4  Has relevent experience    Part time course        Graduate   \n",
       "\n",
       "  major_discipline experience company_size company_type last_new_job  \\\n",
       "0             STEM        >20          NaN          NaN            1   \n",
       "1             STEM         15        50-99      Pvt Ltd           >4   \n",
       "2             STEM          5          NaN          NaN        never   \n",
       "3  Business Degree         <1          NaN      Pvt Ltd        never   \n",
       "4             STEM         11          NaN          NaN            1   \n",
       "\n",
       "   training_hours  target  \n",
       "0              36     1.0  \n",
       "1              47     0.0  \n",
       "2              83     0.0  \n",
       "3              52     1.0  \n",
       "4              24     1.0  "
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "7102e02c-e34b-4569-a54b-9a2e48ba0726",
   "metadata": {},
   "outputs": [],
   "source": [
    "### Dropeando nulos "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "b29aa3d0-9a8c-4658-8ddb-366fad699430",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "enrollee_id                  0\n",
       "city                         0\n",
       "city_development_index       0\n",
       "gender                    3601\n",
       "relevent_experience          0\n",
       "enrolled_university        302\n",
       "education_level            369\n",
       "major_discipline          2237\n",
       "experience                  50\n",
       "company_size              4734\n",
       "company_type              4891\n",
       "last_new_job               339\n",
       "training_hours               0\n",
       "target                       0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "f6afb813-0861-4a33-8869-8877037af0dc",
   "metadata": {},
   "outputs": [],
   "source": [
    "df['target']=df['target'].astype('int')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "6009809d-5484-40aa-aacb-b8b55153eba1",
   "metadata": {},
   "outputs": [],
   "source": [
    "target= df.target"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "f28eb282-5cd3-4c5d-bfb7-90889a584a9a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(3824, 11502)"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "positivo= target.sum()\n",
    "negativo= target.shape[0]-positivo\n",
    "positivo, negativo"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "e521f424-02cd-49f5-b4c2-97d7b8741b40",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>enrollee_id</th>\n",
       "      <th>city</th>\n",
       "      <th>city_development_index</th>\n",
       "      <th>gender</th>\n",
       "      <th>relevent_experience</th>\n",
       "      <th>enrolled_university</th>\n",
       "      <th>education_level</th>\n",
       "      <th>major_discipline</th>\n",
       "      <th>experience</th>\n",
       "      <th>company_size</th>\n",
       "      <th>company_type</th>\n",
       "      <th>last_new_job</th>\n",
       "      <th>training_hours</th>\n",
       "      <th>target</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>5454</td>\n",
       "      <td>city_160</td>\n",
       "      <td>0.920</td>\n",
       "      <td>Male</td>\n",
       "      <td>Has relevent experience</td>\n",
       "      <td>no_enrollment</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>Arts</td>\n",
       "      <td>15</td>\n",
       "      <td>50-99</td>\n",
       "      <td>Early Stage Startup</td>\n",
       "      <td>1</td>\n",
       "      <td>22</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1038</td>\n",
       "      <td>city_16</td>\n",
       "      <td>0.910</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Has relevent experience</td>\n",
       "      <td>no_enrollment</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>STEM</td>\n",
       "      <td>13</td>\n",
       "      <td>&lt;10</td>\n",
       "      <td>Pvt Ltd</td>\n",
       "      <td>&gt;4</td>\n",
       "      <td>24</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>9124</td>\n",
       "      <td>city_103</td>\n",
       "      <td>0.920</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Has relevent experience</td>\n",
       "      <td>no_enrollment</td>\n",
       "      <td>Primary School</td>\n",
       "      <td>NaN</td>\n",
       "      <td>13</td>\n",
       "      <td>50-99</td>\n",
       "      <td>Early Stage Startup</td>\n",
       "      <td>2</td>\n",
       "      <td>26</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>5264</td>\n",
       "      <td>city_100</td>\n",
       "      <td>0.887</td>\n",
       "      <td>Male</td>\n",
       "      <td>No relevent experience</td>\n",
       "      <td>no_enrollment</td>\n",
       "      <td>High School</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>never</td>\n",
       "      <td>96</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>9846</td>\n",
       "      <td>city_103</td>\n",
       "      <td>0.920</td>\n",
       "      <td>Male</td>\n",
       "      <td>No relevent experience</td>\n",
       "      <td>no_enrollment</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>STEM</td>\n",
       "      <td>6</td>\n",
       "      <td>100-500</td>\n",
       "      <td>NGO</td>\n",
       "      <td>1</td>\n",
       "      <td>54</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7643</th>\n",
       "      <td>9651</td>\n",
       "      <td>city_100</td>\n",
       "      <td>0.887</td>\n",
       "      <td>NaN</td>\n",
       "      <td>No relevent experience</td>\n",
       "      <td>Full time course</td>\n",
       "      <td>Masters</td>\n",
       "      <td>STEM</td>\n",
       "      <td>3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Public Sector</td>\n",
       "      <td>1</td>\n",
       "      <td>30</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7644</th>\n",
       "      <td>17191</td>\n",
       "      <td>city_21</td>\n",
       "      <td>0.624</td>\n",
       "      <td>NaN</td>\n",
       "      <td>No relevent experience</td>\n",
       "      <td>Full time course</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>STEM</td>\n",
       "      <td>4</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>never</td>\n",
       "      <td>48</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7645</th>\n",
       "      <td>251</td>\n",
       "      <td>city_103</td>\n",
       "      <td>0.920</td>\n",
       "      <td>Male</td>\n",
       "      <td>Has relevent experience</td>\n",
       "      <td>no_enrollment</td>\n",
       "      <td>Masters</td>\n",
       "      <td>STEM</td>\n",
       "      <td>9</td>\n",
       "      <td>50-99</td>\n",
       "      <td>Pvt Ltd</td>\n",
       "      <td>1</td>\n",
       "      <td>36</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7646</th>\n",
       "      <td>7386</td>\n",
       "      <td>city_173</td>\n",
       "      <td>0.878</td>\n",
       "      <td>Male</td>\n",
       "      <td>No relevent experience</td>\n",
       "      <td>no_enrollment</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>Humanities</td>\n",
       "      <td>14</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>42</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7647</th>\n",
       "      <td>31398</td>\n",
       "      <td>city_103</td>\n",
       "      <td>0.920</td>\n",
       "      <td>Male</td>\n",
       "      <td>Has relevent experience</td>\n",
       "      <td>no_enrollment</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>STEM</td>\n",
       "      <td>14</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4</td>\n",
       "      <td>52</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>7648 rows × 14 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      enrollee_id      city  city_development_index gender  \\\n",
       "0            5454  city_160                   0.920   Male   \n",
       "1            1038   city_16                   0.910    NaN   \n",
       "2            9124  city_103                   0.920    NaN   \n",
       "3            5264  city_100                   0.887   Male   \n",
       "4            9846  city_103                   0.920   Male   \n",
       "...           ...       ...                     ...    ...   \n",
       "7643         9651  city_100                   0.887    NaN   \n",
       "7644        17191   city_21                   0.624    NaN   \n",
       "7645          251  city_103                   0.920   Male   \n",
       "7646         7386  city_173                   0.878   Male   \n",
       "7647        31398  city_103                   0.920   Male   \n",
       "\n",
       "          relevent_experience enrolled_university education_level  \\\n",
       "0     Has relevent experience       no_enrollment        Graduate   \n",
       "1     Has relevent experience       no_enrollment        Graduate   \n",
       "2     Has relevent experience       no_enrollment  Primary School   \n",
       "3      No relevent experience       no_enrollment     High School   \n",
       "4      No relevent experience       no_enrollment        Graduate   \n",
       "...                       ...                 ...             ...   \n",
       "7643   No relevent experience    Full time course         Masters   \n",
       "7644   No relevent experience    Full time course        Graduate   \n",
       "7645  Has relevent experience       no_enrollment         Masters   \n",
       "7646   No relevent experience       no_enrollment        Graduate   \n",
       "7647  Has relevent experience       no_enrollment        Graduate   \n",
       "\n",
       "     major_discipline experience company_size         company_type  \\\n",
       "0                Arts         15        50-99  Early Stage Startup   \n",
       "1                STEM         13          <10              Pvt Ltd   \n",
       "2                 NaN         13        50-99  Early Stage Startup   \n",
       "3                 NaN          3          NaN                  NaN   \n",
       "4                STEM          6      100-500                  NGO   \n",
       "...               ...        ...          ...                  ...   \n",
       "7643             STEM          3          NaN        Public Sector   \n",
       "7644             STEM          4          NaN                  NaN   \n",
       "7645             STEM          9        50-99              Pvt Ltd   \n",
       "7646       Humanities         14          NaN                  NaN   \n",
       "7647             STEM         14          NaN                  NaN   \n",
       "\n",
       "     last_new_job  training_hours  target  \n",
       "0               1              22       0  \n",
       "1              >4              24       0  \n",
       "2               2              26       0  \n",
       "3           never              96       0  \n",
       "4               1              54       0  \n",
       "...           ...             ...     ...  \n",
       "7643            1              30       1  \n",
       "7644        never              48       1  \n",
       "7645            1              36       1  \n",
       "7646            1              42       1  \n",
       "7647            4              52       1  \n",
       "\n",
       "[7648 rows x 14 columns]"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data_rus, targetrus= rus.fit_resample(df, target)\n",
    "positivo_rus=targetrus.sum()\n",
    "negativo_rus=targetrus.shape[0]-positivo_rus\n",
    "data_rus"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "5406eda7-4c42-4d2c-b5b0-30009e7dd79c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    3824\n",
       "1    3824\n",
       "Name: target, dtype: int64"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data_rus.target.value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "85cd453a-c5fe-4bc6-bb8b-01f143a0e9b0",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 7648 entries, 0 to 7647\n",
      "Data columns (total 14 columns):\n",
      " #   Column                  Non-Null Count  Dtype  \n",
      "---  ------                  --------------  -----  \n",
      " 0   enrollee_id             7648 non-null   int64  \n",
      " 1   city                    7648 non-null   object \n",
      " 2   city_development_index  7648 non-null   float64\n",
      " 3   gender                  5705 non-null   object \n",
      " 4   relevent_experience     7648 non-null   object \n",
      " 5   enrolled_university     7494 non-null   object \n",
      " 6   education_level         7471 non-null   object \n",
      " 7   major_discipline        6634 non-null   object \n",
      " 8   experience              7621 non-null   object \n",
      " 9   company_size            4782 non-null   object \n",
      " 10  company_type            4743 non-null   object \n",
      " 11  last_new_job            7460 non-null   object \n",
      " 12  training_hours          7648 non-null   int64  \n",
      " 13  target                  7648 non-null   int32  \n",
      "dtypes: float64(1), int32(1), int64(2), object(10)\n",
      "memory usage: 806.8+ KB\n"
     ]
    }
   ],
   "source": [
    "data_rus.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "a89df5ad-c9e0-4ba2-83a0-11ed65695260",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "enrollee_id                  0\n",
       "city                         0\n",
       "city_development_index       0\n",
       "relevent_experience          0\n",
       "training_hours               0\n",
       "target                       0\n",
       "experience                  27\n",
       "enrolled_university        154\n",
       "education_level            177\n",
       "last_new_job               188\n",
       "major_discipline          1014\n",
       "gender                    1943\n",
       "company_size              2866\n",
       "company_type              2905\n",
       "dtype: int64"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data_rus.isna().sum().sort_values()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "606c8f37-7501-41a2-ae2c-ff6bbc852cc0",
   "metadata": {},
   "outputs": [],
   "source": [
    "data_rus.experience.replace('>20','21', inplace=True)\n",
    "data_rus.experience.replace('<1','0', inplace=True)\n",
    "data_rus.experience= pd.to_numeric(data_rus.experience)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "5f52907d-f55e-4aae-b491-df8a993b3cc7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1        3327\n",
       ">4       1183\n",
       "2        1110\n",
       "never    1057\n",
       "4         396\n",
       "3         387\n",
       "Name: last_new_job, dtype: int64"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data_rus.last_new_job.value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "14401bef-eaef-4b01-8df0-71c66613b94e",
   "metadata": {},
   "outputs": [],
   "source": [
    "data_rus.last_new_job.replace('>4','5', inplace=True)\n",
    "data_rus.last_new_job.replace('never','0', inplace=True)\n",
    "data_rus.last_new_job= pd.to_numeric(data_rus.last_new_job)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "2703ee4b-baf3-4cf6-a1f2-90554950071e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1.0    3327\n",
       "5.0    1183\n",
       "2.0    1110\n",
       "0.0    1057\n",
       "4.0     396\n",
       "3.0     387\n",
       "Name: last_new_job, dtype: int64"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data_rus.last_new_job.value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "9dd2e883-660f-4f45-9078-3e5205177fa5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "50-99        1110\n",
       "100-500       907\n",
       "10000+        752\n",
       "10/49         590\n",
       "<10           461\n",
       "1000-4999     457\n",
       "500-999       298\n",
       "5000-9999     207\n",
       "Name: company_size, dtype: int64"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data_rus.company_size.value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "9a978207-9b58-4807-aba9-4a2921b39e22",
   "metadata": {},
   "outputs": [],
   "source": [
    "data_rus.company_size.replace('10000+','10000', inplace=True)\n",
    "data_rus.company_size.replace('10/49','10-49', inplace=True)\n",
    "data_rus.company_size.replace('<10','10', inplace=True)\n",
    "data_rus.company_size.replace('50-99','50-99', inplace=True)\n",
    "data_rus.company_size.replace('1000-4999','1000-4999', inplace=True)\n",
    "data_rus.company_size.replace('500-999','500-999', inplace=True)\n",
    "data_rus.company_size.replace('5000-9999','5000-9999', inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "61138b02-a4c0-4b4c-b7de-4dfb42fcb9fd",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "50-99        1110\n",
       "100-500       907\n",
       "10000         752\n",
       "10-49         590\n",
       "10            461\n",
       "1000-4999     457\n",
       "500-999       298\n",
       "5000-9999     207\n",
       "Name: company_size, dtype: int64"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data_rus.company_size.value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "a55c41d9-2658-40d0-8522-e66f7e523911",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0         50-99\n",
       "1            10\n",
       "2         50-99\n",
       "3           NaN\n",
       "4       100-500\n",
       "         ...   \n",
       "7643        NaN\n",
       "7644        NaN\n",
       "7645      50-99\n",
       "7646        NaN\n",
       "7647        NaN\n",
       "Name: company_size, Length: 7648, dtype: object"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data_rus['company_size']=data_rus['company_size'].astype('object')\n",
    "data_rus['company_size']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 163,
   "id": "c3888f39-ccb0-4f3b-a8ae-c2a7aebbb343",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "((6118, 12), (1530, 12))"
      ]
     },
     "execution_count": 163,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X_train, X_test, y_train, y_test = train_test_split(data_rus.drop(['enrollee_id', 'target'], axis=1), \n",
    "                                                    data_rus['target'], \n",
    "                                                    test_size=0.2, \n",
    "                                                    random_state=42\n",
    "                                                    )\n",
    "\n",
    "X_train.shape, X_test.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 164,
   "id": "124bc841-f9e1-4307-ae25-4195c8a1e0e9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "city                         0\n",
       "city_development_index       0\n",
       "relevent_experience          0\n",
       "training_hours               0\n",
       "experience                  23\n",
       "enrolled_university        119\n",
       "education_level            140\n",
       "last_new_job               156\n",
       "major_discipline           818\n",
       "gender                    1583\n",
       "company_size              2281\n",
       "company_type              2305\n",
       "dtype: int64"
      ]
     },
     "execution_count": 164,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X_train.isna().sum().sort_values()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 165,
   "id": "0fa855db-5f3d-4606-99a9-7b9612315b81",
   "metadata": {},
   "outputs": [],
   "source": [
    "#X_train= X_train[X_train['last_new_job'].notna()]\n",
    "#X_test= X_test[X_test['last_new_job'].notna()]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 166,
   "id": "1a3e29c9-793b-4b16-a8fd-555fc9eadd9c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "Int64Index: 6118 entries, 1513 to 7270\n",
      "Data columns (total 12 columns):\n",
      " #   Column                  Non-Null Count  Dtype  \n",
      "---  ------                  --------------  -----  \n",
      " 0   city                    6118 non-null   object \n",
      " 1   city_development_index  6118 non-null   float64\n",
      " 2   gender                  4535 non-null   object \n",
      " 3   relevent_experience     6118 non-null   object \n",
      " 4   enrolled_university     5999 non-null   object \n",
      " 5   education_level         5978 non-null   object \n",
      " 6   major_discipline        5300 non-null   object \n",
      " 7   experience              6095 non-null   float64\n",
      " 8   company_size            3837 non-null   object \n",
      " 9   company_type            3813 non-null   object \n",
      " 10  last_new_job            5962 non-null   float64\n",
      " 11  training_hours          6118 non-null   int64  \n",
      "dtypes: float64(3), int64(1), object(8)\n",
      "memory usage: 621.4+ KB\n"
     ]
    }
   ],
   "source": [
    "X_train.info()"
   ]
  },
  {
   "cell_type": "raw",
   "id": "a163acff-d441-463f-8008-2c9c527f268e",
   "metadata": {},
   "source": [
    "++++ ESTO CAMBIO +++"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 167,
   "id": "33b7e1db-7d2a-4b7f-9e60-506cf8698373",
   "metadata": {},
   "outputs": [],
   "source": [
    "impmiss = mdi.CategoricalImputer('missing', variables = ['enrolled_university', 'education_level','major_discipline', 'company_size', 'gender', 'company_type'])\n",
    "X_train = impmiss.fit_transform(X_train)\n",
    "impmisstest = mdi.CategoricalImputer('missing', variables = ['enrolled_university', 'education_level','major_discipline', 'company_size', 'gender', 'company_type'])\n",
    "X_test = impmisstest.fit_transform(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 168,
   "id": "256f97b5-b577-40a7-b854-0f6568fc7603",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "city                        0\n",
       "city_development_index      0\n",
       "gender                      0\n",
       "relevent_experience         0\n",
       "enrolled_university         0\n",
       "education_level             0\n",
       "major_discipline            0\n",
       "company_size                0\n",
       "company_type                0\n",
       "training_hours              0\n",
       "experience                 23\n",
       "last_new_job              156\n",
       "dtype: int64"
      ]
     },
     "execution_count": 168,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X_train.isna().sum().sort_values()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 169,
   "id": "73cb1a10-867b-44e2-a28a-44e1d9d9e885",
   "metadata": {},
   "outputs": [],
   "source": [
    "impmean= mdi.MeanMedianImputer(imputation_method='mean', variables=['experience','last_new_job'])\n",
    "X_train = impmean.fit_transform(X_train) \n",
    "impmeantest= mdi.MeanMedianImputer(imputation_method='mean', variables=['experience', 'last_new_job'])\n",
    "X_test = impmeantest.fit_transform(X_test) "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 170,
   "id": "5fe18ac6-f0c5-4e98-8bbe-0669da5e9c8e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "city                      0\n",
       "city_development_index    0\n",
       "gender                    0\n",
       "relevent_experience       0\n",
       "enrolled_university       0\n",
       "education_level           0\n",
       "major_discipline          0\n",
       "experience                0\n",
       "company_size              0\n",
       "company_type              0\n",
       "last_new_job              0\n",
       "training_hours            0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 170,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X_train.isna().sum().sort_values()"
   ]
  },
  {
   "cell_type": "raw",
   "id": "1e1a5bbc-acb9-468e-bed6-608be73b8d45",
   "metadata": {},
   "source": [
    "label_enc = preprocessing.LabelEncoder()"
   ]
  },
  {
   "cell_type": "raw",
   "id": "1ed0d35f-4921-4bf9-a080-03de06941523",
   "metadata": {},
   "source": [
    "X_train_codif = label_enc.fit_transform(X_train['relevent_experience'])\n",
    "X_test_codif = label_enc.fit_transform(X_test['relevent_experience'])"
   ]
  },
  {
   "cell_type": "raw",
   "id": "2b7c4e15-798f-4a1d-9ea9-7096ebd0764a",
   "metadata": {},
   "source": [
    "pd.DataFrame({\n",
    "    \"original\": X_train['relevent_experience'][:6],\n",
    "    \"codificada\": X_train_codif [:6]\n",
    "})"
   ]
  },
  {
   "cell_type": "raw",
   "id": "05824ad7-98d0-493f-880d-c3619e6b6b8a",
   "metadata": {},
   "source": [
    "pd.DataFrame({\n",
    "    \"original\": X_test['relevent_experience'][:6],\n",
    "    \"codificada\": X_test_codif  [:6]\n",
    "})"
   ]
  },
  {
   "cell_type": "raw",
   "id": "c68d6859-b2c7-4ecc-8fba-21756f89e022",
   "metadata": {},
   "source": [
    "X_train['relevent_experience']=label_enc.fit_transform(X_train['relevent_experience'])\n",
    "X_test['relevent_experience']=label_enc.fit_transform(X_test['relevent_experience'])"
   ]
  },
  {
   "cell_type": "raw",
   "id": "22b68866-c67c-4154-9c77-87da994e064f",
   "metadata": {},
   "source": [
    "X_train_codif = label_enc.fit_transform(X_train['enrolled_university'])"
   ]
  },
  {
   "cell_type": "raw",
   "id": "9f611825-0c7b-4fff-8e13-d08af5190114",
   "metadata": {},
   "source": [
    "X_test_codif = label_enc.fit_transform(X_test['enrolled_university'])"
   ]
  },
  {
   "cell_type": "raw",
   "id": "ff04a022-87af-4358-8127-4d1ff6e1f17a",
   "metadata": {},
   "source": [
    "pd.DataFrame({\n",
    "    \"original\": X_train['enrolled_university'][:6],\n",
    "    \"codificada\": X_train_codif [:6]\n",
    "})"
   ]
  },
  {
   "cell_type": "raw",
   "id": "4a243552-c2f6-4a95-afe4-8412fa363769",
   "metadata": {},
   "source": [
    "pd.DataFrame({\n",
    "    \"original\": X_test['enrolled_university'][:6],\n",
    "    \"codificada\": X_test_codif  [:6]\n",
    "})"
   ]
  },
  {
   "cell_type": "raw",
   "id": "3128d8de-3c2c-426b-9950-00f64964999c",
   "metadata": {},
   "source": [
    "X_train['enrolled_university']=label_enc.fit_transform(X_train['enrolled_university'])\n",
    "X_test['enrolled_university']=label_enc.fit_transform(X_test['enrolled_university'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 171,
   "id": "9855a573-69f7-4af2-a470-17c694b1e6d2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>city</th>\n",
       "      <th>city_development_index</th>\n",
       "      <th>gender</th>\n",
       "      <th>relevent_experience</th>\n",
       "      <th>enrolled_university</th>\n",
       "      <th>education_level</th>\n",
       "      <th>major_discipline</th>\n",
       "      <th>experience</th>\n",
       "      <th>company_size</th>\n",
       "      <th>company_type</th>\n",
       "      <th>last_new_job</th>\n",
       "      <th>training_hours</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1513</th>\n",
       "      <td>city_73</td>\n",
       "      <td>0.754</td>\n",
       "      <td>Male</td>\n",
       "      <td>Has relevent experience</td>\n",
       "      <td>no_enrollment</td>\n",
       "      <td>Masters</td>\n",
       "      <td>STEM</td>\n",
       "      <td>21.0</td>\n",
       "      <td>10</td>\n",
       "      <td>Early Stage Startup</td>\n",
       "      <td>5.0</td>\n",
       "      <td>46</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>216</th>\n",
       "      <td>city_103</td>\n",
       "      <td>0.920</td>\n",
       "      <td>Female</td>\n",
       "      <td>Has relevent experience</td>\n",
       "      <td>no_enrollment</td>\n",
       "      <td>Missing</td>\n",
       "      <td>Missing</td>\n",
       "      <td>21.0</td>\n",
       "      <td>Missing</td>\n",
       "      <td>Missing</td>\n",
       "      <td>5.0</td>\n",
       "      <td>56</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4391</th>\n",
       "      <td>city_21</td>\n",
       "      <td>0.624</td>\n",
       "      <td>Missing</td>\n",
       "      <td>No relevent experience</td>\n",
       "      <td>Full time course</td>\n",
       "      <td>High School</td>\n",
       "      <td>Missing</td>\n",
       "      <td>5.0</td>\n",
       "      <td>Missing</td>\n",
       "      <td>Missing</td>\n",
       "      <td>0.0</td>\n",
       "      <td>91</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6118</th>\n",
       "      <td>city_145</td>\n",
       "      <td>0.555</td>\n",
       "      <td>Missing</td>\n",
       "      <td>Has relevent experience</td>\n",
       "      <td>no_enrollment</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>STEM</td>\n",
       "      <td>6.0</td>\n",
       "      <td>50-99</td>\n",
       "      <td>Pvt Ltd</td>\n",
       "      <td>5.0</td>\n",
       "      <td>55</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>421</th>\n",
       "      <td>city_21</td>\n",
       "      <td>0.624</td>\n",
       "      <td>Missing</td>\n",
       "      <td>Has relevent experience</td>\n",
       "      <td>Full time course</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>STEM</td>\n",
       "      <td>5.0</td>\n",
       "      <td>10000</td>\n",
       "      <td>Pvt Ltd</td>\n",
       "      <td>1.0</td>\n",
       "      <td>50</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "          city  city_development_index   gender      relevent_experience  \\\n",
       "1513   city_73                   0.754     Male  Has relevent experience   \n",
       "216   city_103                   0.920   Female  Has relevent experience   \n",
       "4391   city_21                   0.624  Missing   No relevent experience   \n",
       "6118  city_145                   0.555  Missing  Has relevent experience   \n",
       "421    city_21                   0.624  Missing  Has relevent experience   \n",
       "\n",
       "     enrolled_university education_level major_discipline  experience  \\\n",
       "1513       no_enrollment         Masters             STEM        21.0   \n",
       "216        no_enrollment         Missing          Missing        21.0   \n",
       "4391    Full time course     High School          Missing         5.0   \n",
       "6118       no_enrollment        Graduate             STEM         6.0   \n",
       "421     Full time course        Graduate             STEM         5.0   \n",
       "\n",
       "     company_size         company_type  last_new_job  training_hours  \n",
       "1513           10  Early Stage Startup           5.0              46  \n",
       "216       Missing              Missing           5.0              56  \n",
       "4391      Missing              Missing           0.0              91  \n",
       "6118        50-99              Pvt Ltd           5.0              55  \n",
       "421         10000              Pvt Ltd           1.0              50  "
      ]
     },
     "execution_count": 171,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X_train.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 172,
   "id": "d2db15f9-c87f-431c-a855-90c518c3dcbf",
   "metadata": {},
   "outputs": [],
   "source": [
    "onehot = OneHotEncoder( handle_unknown='ignore', sparse = False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 173,
   "id": "a7732c33-4da4-4eee-a586-fac9555ab167",
   "metadata": {},
   "outputs": [],
   "source": [
    "data_onehot= onehot.fit_transform(X_train[['company_size', 'major_discipline', 'education_level']])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 174,
   "id": "88044858-4c4b-490d-ad59-605de682121f",
   "metadata": {},
   "outputs": [],
   "source": [
    "data_onehot_test= onehot.fit_transform(X_test[['company_size', 'major_discipline', 'education_level']])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 175,
   "id": "d8d0671c-878c-49da-b849-d53f2cc2a305",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>city</th>\n",
       "      <th>city_development_index</th>\n",
       "      <th>gender</th>\n",
       "      <th>relevent_experience</th>\n",
       "      <th>enrolled_university</th>\n",
       "      <th>education_level</th>\n",
       "      <th>major_discipline</th>\n",
       "      <th>experience</th>\n",
       "      <th>company_size</th>\n",
       "      <th>company_type</th>\n",
       "      <th>...</th>\n",
       "      <th>major_discipline_Missing</th>\n",
       "      <th>major_discipline_No Major</th>\n",
       "      <th>major_discipline_Other</th>\n",
       "      <th>major_discipline_STEM</th>\n",
       "      <th>education_level_Graduate</th>\n",
       "      <th>education_level_High School</th>\n",
       "      <th>education_level_Masters</th>\n",
       "      <th>education_level_Missing</th>\n",
       "      <th>education_level_Phd</th>\n",
       "      <th>education_level_Primary School</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1513</th>\n",
       "      <td>city_73</td>\n",
       "      <td>0.754</td>\n",
       "      <td>Male</td>\n",
       "      <td>Has relevent experience</td>\n",
       "      <td>no_enrollment</td>\n",
       "      <td>Masters</td>\n",
       "      <td>STEM</td>\n",
       "      <td>21.0</td>\n",
       "      <td>10</td>\n",
       "      <td>Early Stage Startup</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>216</th>\n",
       "      <td>city_103</td>\n",
       "      <td>0.920</td>\n",
       "      <td>Female</td>\n",
       "      <td>Has relevent experience</td>\n",
       "      <td>no_enrollment</td>\n",
       "      <td>Missing</td>\n",
       "      <td>Missing</td>\n",
       "      <td>21.0</td>\n",
       "      <td>Missing</td>\n",
       "      <td>Missing</td>\n",
       "      <td>...</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4391</th>\n",
       "      <td>city_21</td>\n",
       "      <td>0.624</td>\n",
       "      <td>Missing</td>\n",
       "      <td>No relevent experience</td>\n",
       "      <td>Full time course</td>\n",
       "      <td>High School</td>\n",
       "      <td>Missing</td>\n",
       "      <td>5.0</td>\n",
       "      <td>Missing</td>\n",
       "      <td>Missing</td>\n",
       "      <td>...</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6118</th>\n",
       "      <td>city_145</td>\n",
       "      <td>0.555</td>\n",
       "      <td>Missing</td>\n",
       "      <td>Has relevent experience</td>\n",
       "      <td>no_enrollment</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>STEM</td>\n",
       "      <td>6.0</td>\n",
       "      <td>50-99</td>\n",
       "      <td>Pvt Ltd</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>421</th>\n",
       "      <td>city_21</td>\n",
       "      <td>0.624</td>\n",
       "      <td>Missing</td>\n",
       "      <td>Has relevent experience</td>\n",
       "      <td>Full time course</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>STEM</td>\n",
       "      <td>5.0</td>\n",
       "      <td>10000</td>\n",
       "      <td>Pvt Ltd</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 34 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          city  city_development_index   gender      relevent_experience  \\\n",
       "1513   city_73                   0.754     Male  Has relevent experience   \n",
       "216   city_103                   0.920   Female  Has relevent experience   \n",
       "4391   city_21                   0.624  Missing   No relevent experience   \n",
       "6118  city_145                   0.555  Missing  Has relevent experience   \n",
       "421    city_21                   0.624  Missing  Has relevent experience   \n",
       "\n",
       "     enrolled_university education_level major_discipline  experience  \\\n",
       "1513       no_enrollment         Masters             STEM        21.0   \n",
       "216        no_enrollment         Missing          Missing        21.0   \n",
       "4391    Full time course     High School          Missing         5.0   \n",
       "6118       no_enrollment        Graduate             STEM         6.0   \n",
       "421     Full time course        Graduate             STEM         5.0   \n",
       "\n",
       "     company_size         company_type  ...  major_discipline_Missing  \\\n",
       "1513           10  Early Stage Startup  ...                       0.0   \n",
       "216       Missing              Missing  ...                       1.0   \n",
       "4391      Missing              Missing  ...                       1.0   \n",
       "6118        50-99              Pvt Ltd  ...                       0.0   \n",
       "421         10000              Pvt Ltd  ...                       0.0   \n",
       "\n",
       "      major_discipline_No Major  major_discipline_Other  \\\n",
       "1513                        0.0                     0.0   \n",
       "216                         0.0                     0.0   \n",
       "4391                        0.0                     0.0   \n",
       "6118                        0.0                     0.0   \n",
       "421                         0.0                     0.0   \n",
       "\n",
       "      major_discipline_STEM  education_level_Graduate  \\\n",
       "1513                    1.0                       0.0   \n",
       "216                     0.0                       0.0   \n",
       "4391                    0.0                       0.0   \n",
       "6118                    1.0                       1.0   \n",
       "421                     1.0                       1.0   \n",
       "\n",
       "      education_level_High School  education_level_Masters  \\\n",
       "1513                          0.0                      1.0   \n",
       "216                           0.0                      0.0   \n",
       "4391                          1.0                      0.0   \n",
       "6118                          0.0                      0.0   \n",
       "421                           0.0                      0.0   \n",
       "\n",
       "      education_level_Missing  education_level_Phd  \\\n",
       "1513                      0.0                  0.0   \n",
       "216                       1.0                  0.0   \n",
       "4391                      0.0                  0.0   \n",
       "6118                      0.0                  0.0   \n",
       "421                       0.0                  0.0   \n",
       "\n",
       "      education_level_Primary School  \n",
       "1513                             0.0  \n",
       "216                              0.0  \n",
       "4391                             0.0  \n",
       "6118                             0.0  \n",
       "421                              0.0  \n",
       "\n",
       "[5 rows x 34 columns]"
      ]
     },
     "execution_count": 175,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X_train[onehot.get_feature_names_out()] = data_onehot\n",
    "X_train.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 176,
   "id": "6613728b-081f-4dd9-8ec5-522fd94e7fe9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>city</th>\n",
       "      <th>city_development_index</th>\n",
       "      <th>gender</th>\n",
       "      <th>relevent_experience</th>\n",
       "      <th>enrolled_university</th>\n",
       "      <th>education_level</th>\n",
       "      <th>major_discipline</th>\n",
       "      <th>experience</th>\n",
       "      <th>company_size</th>\n",
       "      <th>company_type</th>\n",
       "      <th>...</th>\n",
       "      <th>major_discipline_Missing</th>\n",
       "      <th>major_discipline_No Major</th>\n",
       "      <th>major_discipline_Other</th>\n",
       "      <th>major_discipline_STEM</th>\n",
       "      <th>education_level_Graduate</th>\n",
       "      <th>education_level_High School</th>\n",
       "      <th>education_level_Masters</th>\n",
       "      <th>education_level_Missing</th>\n",
       "      <th>education_level_Phd</th>\n",
       "      <th>education_level_Primary School</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1513</th>\n",
       "      <td>city_73</td>\n",
       "      <td>0.754</td>\n",
       "      <td>Male</td>\n",
       "      <td>Has relevent experience</td>\n",
       "      <td>no_enrollment</td>\n",
       "      <td>Masters</td>\n",
       "      <td>STEM</td>\n",
       "      <td>21.0</td>\n",
       "      <td>10</td>\n",
       "      <td>Early Stage Startup</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>216</th>\n",
       "      <td>city_103</td>\n",
       "      <td>0.920</td>\n",
       "      <td>Female</td>\n",
       "      <td>Has relevent experience</td>\n",
       "      <td>no_enrollment</td>\n",
       "      <td>Missing</td>\n",
       "      <td>Missing</td>\n",
       "      <td>21.0</td>\n",
       "      <td>Missing</td>\n",
       "      <td>Missing</td>\n",
       "      <td>...</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4391</th>\n",
       "      <td>city_21</td>\n",
       "      <td>0.624</td>\n",
       "      <td>Missing</td>\n",
       "      <td>No relevent experience</td>\n",
       "      <td>Full time course</td>\n",
       "      <td>High School</td>\n",
       "      <td>Missing</td>\n",
       "      <td>5.0</td>\n",
       "      <td>Missing</td>\n",
       "      <td>Missing</td>\n",
       "      <td>...</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6118</th>\n",
       "      <td>city_145</td>\n",
       "      <td>0.555</td>\n",
       "      <td>Missing</td>\n",
       "      <td>Has relevent experience</td>\n",
       "      <td>no_enrollment</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>STEM</td>\n",
       "      <td>6.0</td>\n",
       "      <td>50-99</td>\n",
       "      <td>Pvt Ltd</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>421</th>\n",
       "      <td>city_21</td>\n",
       "      <td>0.624</td>\n",
       "      <td>Missing</td>\n",
       "      <td>Has relevent experience</td>\n",
       "      <td>Full time course</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>STEM</td>\n",
       "      <td>5.0</td>\n",
       "      <td>10000</td>\n",
       "      <td>Pvt Ltd</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 34 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          city  city_development_index   gender      relevent_experience  \\\n",
       "1513   city_73                   0.754     Male  Has relevent experience   \n",
       "216   city_103                   0.920   Female  Has relevent experience   \n",
       "4391   city_21                   0.624  Missing   No relevent experience   \n",
       "6118  city_145                   0.555  Missing  Has relevent experience   \n",
       "421    city_21                   0.624  Missing  Has relevent experience   \n",
       "\n",
       "     enrolled_university education_level major_discipline  experience  \\\n",
       "1513       no_enrollment         Masters             STEM        21.0   \n",
       "216        no_enrollment         Missing          Missing        21.0   \n",
       "4391    Full time course     High School          Missing         5.0   \n",
       "6118       no_enrollment        Graduate             STEM         6.0   \n",
       "421     Full time course        Graduate             STEM         5.0   \n",
       "\n",
       "     company_size         company_type  ...  major_discipline_Missing  \\\n",
       "1513           10  Early Stage Startup  ...                       0.0   \n",
       "216       Missing              Missing  ...                       1.0   \n",
       "4391      Missing              Missing  ...                       1.0   \n",
       "6118        50-99              Pvt Ltd  ...                       0.0   \n",
       "421         10000              Pvt Ltd  ...                       0.0   \n",
       "\n",
       "      major_discipline_No Major  major_discipline_Other  \\\n",
       "1513                        0.0                     0.0   \n",
       "216                         0.0                     0.0   \n",
       "4391                        0.0                     0.0   \n",
       "6118                        0.0                     0.0   \n",
       "421                         0.0                     0.0   \n",
       "\n",
       "      major_discipline_STEM  education_level_Graduate  \\\n",
       "1513                    1.0                       0.0   \n",
       "216                     0.0                       0.0   \n",
       "4391                    0.0                       0.0   \n",
       "6118                    1.0                       1.0   \n",
       "421                     1.0                       1.0   \n",
       "\n",
       "      education_level_High School  education_level_Masters  \\\n",
       "1513                          0.0                      1.0   \n",
       "216                           0.0                      0.0   \n",
       "4391                          1.0                      0.0   \n",
       "6118                          0.0                      0.0   \n",
       "421                           0.0                      0.0   \n",
       "\n",
       "      education_level_Missing  education_level_Phd  \\\n",
       "1513                      0.0                  0.0   \n",
       "216                       1.0                  0.0   \n",
       "4391                      0.0                  0.0   \n",
       "6118                      0.0                  0.0   \n",
       "421                       0.0                  0.0   \n",
       "\n",
       "      education_level_Primary School  \n",
       "1513                             0.0  \n",
       "216                              0.0  \n",
       "4391                             0.0  \n",
       "6118                             0.0  \n",
       "421                              0.0  \n",
       "\n",
       "[5 rows x 34 columns]"
      ]
     },
     "execution_count": 176,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X_train[onehot.get_feature_names_out()] = data_onehot\n",
    "X_train.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 177,
   "id": "1f6bf5b4-4840-474f-a145-72f71340c6c2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>city</th>\n",
       "      <th>city_development_index</th>\n",
       "      <th>gender</th>\n",
       "      <th>relevent_experience</th>\n",
       "      <th>enrolled_university</th>\n",
       "      <th>education_level</th>\n",
       "      <th>major_discipline</th>\n",
       "      <th>experience</th>\n",
       "      <th>company_size</th>\n",
       "      <th>company_type</th>\n",
       "      <th>...</th>\n",
       "      <th>major_discipline_Missing</th>\n",
       "      <th>major_discipline_No Major</th>\n",
       "      <th>major_discipline_Other</th>\n",
       "      <th>major_discipline_STEM</th>\n",
       "      <th>education_level_Graduate</th>\n",
       "      <th>education_level_High School</th>\n",
       "      <th>education_level_Masters</th>\n",
       "      <th>education_level_Missing</th>\n",
       "      <th>education_level_Phd</th>\n",
       "      <th>education_level_Primary School</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>3257</th>\n",
       "      <td>city_16</td>\n",
       "      <td>0.910</td>\n",
       "      <td>Female</td>\n",
       "      <td>No relevent experience</td>\n",
       "      <td>Full time course</td>\n",
       "      <td>High School</td>\n",
       "      <td>Missing</td>\n",
       "      <td>2.0</td>\n",
       "      <td>50-99</td>\n",
       "      <td>Missing</td>\n",
       "      <td>...</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5923</th>\n",
       "      <td>city_74</td>\n",
       "      <td>0.579</td>\n",
       "      <td>Missing</td>\n",
       "      <td>No relevent experience</td>\n",
       "      <td>no_enrollment</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>STEM</td>\n",
       "      <td>6.0</td>\n",
       "      <td>Missing</td>\n",
       "      <td>Missing</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2886</th>\n",
       "      <td>city_16</td>\n",
       "      <td>0.910</td>\n",
       "      <td>Missing</td>\n",
       "      <td>Has relevent experience</td>\n",
       "      <td>Full time course</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>STEM</td>\n",
       "      <td>13.0</td>\n",
       "      <td>50-99</td>\n",
       "      <td>Pvt Ltd</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3968</th>\n",
       "      <td>city_145</td>\n",
       "      <td>0.555</td>\n",
       "      <td>Female</td>\n",
       "      <td>Has relevent experience</td>\n",
       "      <td>Part time course</td>\n",
       "      <td>Masters</td>\n",
       "      <td>STEM</td>\n",
       "      <td>21.0</td>\n",
       "      <td>10000</td>\n",
       "      <td>NGO</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1221</th>\n",
       "      <td>city_103</td>\n",
       "      <td>0.920</td>\n",
       "      <td>Male</td>\n",
       "      <td>Has relevent experience</td>\n",
       "      <td>no_enrollment</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>STEM</td>\n",
       "      <td>16.0</td>\n",
       "      <td>100-500</td>\n",
       "      <td>Pvt Ltd</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 34 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          city  city_development_index   gender      relevent_experience  \\\n",
       "3257   city_16                   0.910   Female   No relevent experience   \n",
       "5923   city_74                   0.579  Missing   No relevent experience   \n",
       "2886   city_16                   0.910  Missing  Has relevent experience   \n",
       "3968  city_145                   0.555   Female  Has relevent experience   \n",
       "1221  city_103                   0.920     Male  Has relevent experience   \n",
       "\n",
       "     enrolled_university education_level major_discipline  experience  \\\n",
       "3257    Full time course     High School          Missing         2.0   \n",
       "5923       no_enrollment        Graduate             STEM         6.0   \n",
       "2886    Full time course        Graduate             STEM        13.0   \n",
       "3968    Part time course         Masters             STEM        21.0   \n",
       "1221       no_enrollment        Graduate             STEM        16.0   \n",
       "\n",
       "     company_size company_type  ...  major_discipline_Missing  \\\n",
       "3257        50-99      Missing  ...                       1.0   \n",
       "5923      Missing      Missing  ...                       0.0   \n",
       "2886        50-99      Pvt Ltd  ...                       0.0   \n",
       "3968        10000          NGO  ...                       0.0   \n",
       "1221      100-500      Pvt Ltd  ...                       0.0   \n",
       "\n",
       "      major_discipline_No Major  major_discipline_Other  \\\n",
       "3257                        0.0                     0.0   \n",
       "5923                        0.0                     0.0   \n",
       "2886                        0.0                     0.0   \n",
       "3968                        0.0                     0.0   \n",
       "1221                        0.0                     0.0   \n",
       "\n",
       "      major_discipline_STEM  education_level_Graduate  \\\n",
       "3257                    0.0                       0.0   \n",
       "5923                    1.0                       1.0   \n",
       "2886                    1.0                       1.0   \n",
       "3968                    1.0                       0.0   \n",
       "1221                    1.0                       1.0   \n",
       "\n",
       "      education_level_High School  education_level_Masters  \\\n",
       "3257                          1.0                      0.0   \n",
       "5923                          0.0                      0.0   \n",
       "2886                          0.0                      0.0   \n",
       "3968                          0.0                      1.0   \n",
       "1221                          0.0                      0.0   \n",
       "\n",
       "      education_level_Missing  education_level_Phd  \\\n",
       "3257                      0.0                  0.0   \n",
       "5923                      0.0                  0.0   \n",
       "2886                      0.0                  0.0   \n",
       "3968                      0.0                  0.0   \n",
       "1221                      0.0                  0.0   \n",
       "\n",
       "      education_level_Primary School  \n",
       "3257                             0.0  \n",
       "5923                             0.0  \n",
       "2886                             0.0  \n",
       "3968                             0.0  \n",
       "1221                             0.0  \n",
       "\n",
       "[5 rows x 34 columns]"
      ]
     },
     "execution_count": 177,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X_test[onehot.get_feature_names_out()] = data_onehot_test\n",
    "X_test.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 178,
   "id": "ac21e19c-a4b4-4662-b157-91e106237c74",
   "metadata": {},
   "outputs": [],
   "source": [
    "freq_enc = CountFrequencyEncoder(encoding_method='frequency', variables=['enrolled_university', 'relevent_experience','company_type'])\n",
    "X_train = freq_enc.fit_transform(X_train.dropna())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 179,
   "id": "7aa5deed-37a9-486b-8c5d-3a91aa61561e",
   "metadata": {},
   "outputs": [],
   "source": [
    "freq_enc = CountFrequencyEncoder(encoding_method='frequency', variables=['enrolled_university', 'relevent_experience', 'company_type'])\n",
    "X_test = freq_enc.fit_transform(X_test.dropna())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 180,
   "id": "6574ce1e-9f2d-4ae0-94b7-52c90b2dad60",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>city</th>\n",
       "      <th>city_development_index</th>\n",
       "      <th>gender</th>\n",
       "      <th>relevent_experience</th>\n",
       "      <th>enrolled_university</th>\n",
       "      <th>education_level</th>\n",
       "      <th>major_discipline</th>\n",
       "      <th>experience</th>\n",
       "      <th>company_size</th>\n",
       "      <th>company_type</th>\n",
       "      <th>...</th>\n",
       "      <th>major_discipline_Missing</th>\n",
       "      <th>major_discipline_No Major</th>\n",
       "      <th>major_discipline_Other</th>\n",
       "      <th>major_discipline_STEM</th>\n",
       "      <th>education_level_Graduate</th>\n",
       "      <th>education_level_High School</th>\n",
       "      <th>education_level_Masters</th>\n",
       "      <th>education_level_Missing</th>\n",
       "      <th>education_level_Phd</th>\n",
       "      <th>education_level_Primary School</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1513</th>\n",
       "      <td>city_73</td>\n",
       "      <td>0.754</td>\n",
       "      <td>Male</td>\n",
       "      <td>0.695162</td>\n",
       "      <td>0.684864</td>\n",
       "      <td>Masters</td>\n",
       "      <td>STEM</td>\n",
       "      <td>21.0</td>\n",
       "      <td>10</td>\n",
       "      <td>0.030239</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>216</th>\n",
       "      <td>city_103</td>\n",
       "      <td>0.920</td>\n",
       "      <td>Female</td>\n",
       "      <td>0.695162</td>\n",
       "      <td>0.684864</td>\n",
       "      <td>Missing</td>\n",
       "      <td>Missing</td>\n",
       "      <td>21.0</td>\n",
       "      <td>Missing</td>\n",
       "      <td>0.376757</td>\n",
       "      <td>...</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4391</th>\n",
       "      <td>city_21</td>\n",
       "      <td>0.624</td>\n",
       "      <td>Missing</td>\n",
       "      <td>0.304838</td>\n",
       "      <td>0.230141</td>\n",
       "      <td>High School</td>\n",
       "      <td>Missing</td>\n",
       "      <td>5.0</td>\n",
       "      <td>Missing</td>\n",
       "      <td>0.376757</td>\n",
       "      <td>...</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6118</th>\n",
       "      <td>city_145</td>\n",
       "      <td>0.555</td>\n",
       "      <td>Missing</td>\n",
       "      <td>0.695162</td>\n",
       "      <td>0.684864</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>STEM</td>\n",
       "      <td>6.0</td>\n",
       "      <td>50-99</td>\n",
       "      <td>0.470742</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>421</th>\n",
       "      <td>city_21</td>\n",
       "      <td>0.624</td>\n",
       "      <td>Missing</td>\n",
       "      <td>0.695162</td>\n",
       "      <td>0.230141</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>STEM</td>\n",
       "      <td>5.0</td>\n",
       "      <td>10000</td>\n",
       "      <td>0.470742</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 34 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          city  city_development_index   gender  relevent_experience  \\\n",
       "1513   city_73                   0.754     Male             0.695162   \n",
       "216   city_103                   0.920   Female             0.695162   \n",
       "4391   city_21                   0.624  Missing             0.304838   \n",
       "6118  city_145                   0.555  Missing             0.695162   \n",
       "421    city_21                   0.624  Missing             0.695162   \n",
       "\n",
       "      enrolled_university education_level major_discipline  experience  \\\n",
       "1513             0.684864         Masters             STEM        21.0   \n",
       "216              0.684864         Missing          Missing        21.0   \n",
       "4391             0.230141     High School          Missing         5.0   \n",
       "6118             0.684864        Graduate             STEM         6.0   \n",
       "421              0.230141        Graduate             STEM         5.0   \n",
       "\n",
       "     company_size  company_type  ...  major_discipline_Missing  \\\n",
       "1513           10      0.030239  ...                       0.0   \n",
       "216       Missing      0.376757  ...                       1.0   \n",
       "4391      Missing      0.376757  ...                       1.0   \n",
       "6118        50-99      0.470742  ...                       0.0   \n",
       "421         10000      0.470742  ...                       0.0   \n",
       "\n",
       "      major_discipline_No Major  major_discipline_Other  \\\n",
       "1513                        0.0                     0.0   \n",
       "216                         0.0                     0.0   \n",
       "4391                        0.0                     0.0   \n",
       "6118                        0.0                     0.0   \n",
       "421                         0.0                     0.0   \n",
       "\n",
       "      major_discipline_STEM  education_level_Graduate  \\\n",
       "1513                    1.0                       0.0   \n",
       "216                     0.0                       0.0   \n",
       "4391                    0.0                       0.0   \n",
       "6118                    1.0                       1.0   \n",
       "421                     1.0                       1.0   \n",
       "\n",
       "      education_level_High School  education_level_Masters  \\\n",
       "1513                          0.0                      1.0   \n",
       "216                           0.0                      0.0   \n",
       "4391                          1.0                      0.0   \n",
       "6118                          0.0                      0.0   \n",
       "421                           0.0                      0.0   \n",
       "\n",
       "      education_level_Missing  education_level_Phd  \\\n",
       "1513                      0.0                  0.0   \n",
       "216                       1.0                  0.0   \n",
       "4391                      0.0                  0.0   \n",
       "6118                      0.0                  0.0   \n",
       "421                       0.0                  0.0   \n",
       "\n",
       "      education_level_Primary School  \n",
       "1513                             0.0  \n",
       "216                              0.0  \n",
       "4391                             0.0  \n",
       "6118                             0.0  \n",
       "421                              0.0  \n",
       "\n",
       "[5 rows x 34 columns]"
      ]
     },
     "execution_count": 180,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X_train.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 181,
   "id": "03556e2b-ede2-4a12-8fac-c7559c2e179b",
   "metadata": {},
   "outputs": [],
   "source": [
    "X_train.drop(['city','major_discipline','company_size', 'education_level', 'gender'], axis=1, inplace=True)\n",
    "X_test.drop(['city','major_discipline','company_size', 'education_level', 'gender'], axis=1, inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 182,
   "id": "3faf2137-816b-41b0-9767-b8d5253e64e8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>city_development_index</th>\n",
       "      <th>relevent_experience</th>\n",
       "      <th>enrolled_university</th>\n",
       "      <th>experience</th>\n",
       "      <th>company_type</th>\n",
       "      <th>last_new_job</th>\n",
       "      <th>training_hours</th>\n",
       "      <th>company_size_10</th>\n",
       "      <th>company_size_10-49</th>\n",
       "      <th>company_size_100-500</th>\n",
       "      <th>...</th>\n",
       "      <th>major_discipline_No Major</th>\n",
       "      <th>major_discipline_Other</th>\n",
       "      <th>major_discipline_STEM</th>\n",
       "      <th>education_level_Graduate</th>\n",
       "      <th>education_level_High School</th>\n",
       "      <th>education_level_Masters</th>\n",
       "      <th>education_level_Missing</th>\n",
       "      <th>education_level_Phd</th>\n",
       "      <th>education_level_Primary School</th>\n",
       "      <th>target</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>city_development_index</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.038108</td>\n",
       "      <td>0.146105</td>\n",
       "      <td>0.373271</td>\n",
       "      <td>-0.015940</td>\n",
       "      <td>0.214989</td>\n",
       "      <td>0.012996</td>\n",
       "      <td>-0.038806</td>\n",
       "      <td>-0.049195</td>\n",
       "      <td>0.011144</td>\n",
       "      <td>...</td>\n",
       "      <td>0.029894</td>\n",
       "      <td>-0.024654</td>\n",
       "      <td>-0.087644</td>\n",
       "      <td>-0.051108</td>\n",
       "      <td>0.026704</td>\n",
       "      <td>0.024830</td>\n",
       "      <td>-0.035799</td>\n",
       "      <td>0.074759</td>\n",
       "      <td>0.015749</td>\n",
       "      <td>-0.362222</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>relevent_experience</th>\n",
       "      <td>0.038108</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.333686</td>\n",
       "      <td>0.338362</td>\n",
       "      <td>0.069129</td>\n",
       "      <td>0.251649</td>\n",
       "      <td>0.009706</td>\n",
       "      <td>0.074478</td>\n",
       "      <td>0.081345</td>\n",
       "      <td>0.138432</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.012285</td>\n",
       "      <td>-0.021716</td>\n",
       "      <td>0.256437</td>\n",
       "      <td>0.105651</td>\n",
       "      <td>-0.253505</td>\n",
       "      <td>0.124738</td>\n",
       "      <td>-0.069628</td>\n",
       "      <td>-0.029535</td>\n",
       "      <td>-0.116343</td>\n",
       "      <td>-0.148431</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>enrolled_university</th>\n",
       "      <td>0.146105</td>\n",
       "      <td>0.333686</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.332599</td>\n",
       "      <td>0.061818</td>\n",
       "      <td>0.229283</td>\n",
       "      <td>0.010209</td>\n",
       "      <td>0.023639</td>\n",
       "      <td>0.011399</td>\n",
       "      <td>0.068999</td>\n",
       "      <td>...</td>\n",
       "      <td>0.022021</td>\n",
       "      <td>0.021717</td>\n",
       "      <td>0.067318</td>\n",
       "      <td>0.010652</td>\n",
       "      <td>-0.173130</td>\n",
       "      <td>0.106172</td>\n",
       "      <td>-0.044038</td>\n",
       "      <td>0.052448</td>\n",
       "      <td>0.016221</td>\n",
       "      <td>-0.142367</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>experience</th>\n",
       "      <td>0.373271</td>\n",
       "      <td>0.338362</td>\n",
       "      <td>0.332599</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.062327</td>\n",
       "      <td>0.475912</td>\n",
       "      <td>0.000709</td>\n",
       "      <td>-0.023778</td>\n",
       "      <td>-0.057788</td>\n",
       "      <td>0.059104</td>\n",
       "      <td>...</td>\n",
       "      <td>0.009864</td>\n",
       "      <td>0.010833</td>\n",
       "      <td>0.122664</td>\n",
       "      <td>-0.043459</td>\n",
       "      <td>-0.161722</td>\n",
       "      <td>0.156716</td>\n",
       "      <td>-0.041725</td>\n",
       "      <td>0.134804</td>\n",
       "      <td>-0.069874</td>\n",
       "      <td>-0.211961</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>company_type</th>\n",
       "      <td>-0.015940</td>\n",
       "      <td>0.069129</td>\n",
       "      <td>0.061818</td>\n",
       "      <td>0.062327</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.065990</td>\n",
       "      <td>0.006223</td>\n",
       "      <td>-0.131353</td>\n",
       "      <td>-0.069630</td>\n",
       "      <td>-0.009465</td>\n",
       "      <td>...</td>\n",
       "      <td>0.011643</td>\n",
       "      <td>0.001159</td>\n",
       "      <td>0.005424</td>\n",
       "      <td>0.049551</td>\n",
       "      <td>-0.004740</td>\n",
       "      <td>-0.020001</td>\n",
       "      <td>-0.010781</td>\n",
       "      <td>-0.092403</td>\n",
       "      <td>-0.001282</td>\n",
       "      <td>-0.000858</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>last_new_job</th>\n",
       "      <td>0.214989</td>\n",
       "      <td>0.251649</td>\n",
       "      <td>0.229283</td>\n",
       "      <td>0.475912</td>\n",
       "      <td>0.065990</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.002625</td>\n",
       "      <td>-0.004688</td>\n",
       "      <td>0.006068</td>\n",
       "      <td>0.040375</td>\n",
       "      <td>...</td>\n",
       "      <td>0.008750</td>\n",
       "      <td>0.003484</td>\n",
       "      <td>0.102320</td>\n",
       "      <td>0.026675</td>\n",
       "      <td>-0.140453</td>\n",
       "      <td>0.080912</td>\n",
       "      <td>-0.056587</td>\n",
       "      <td>0.100850</td>\n",
       "      <td>-0.088293</td>\n",
       "      <td>-0.093104</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>training_hours</th>\n",
       "      <td>0.012996</td>\n",
       "      <td>0.009706</td>\n",
       "      <td>0.010209</td>\n",
       "      <td>0.000709</td>\n",
       "      <td>0.006223</td>\n",
       "      <td>0.002625</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.008930</td>\n",
       "      <td>-0.001774</td>\n",
       "      <td>-0.008305</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.006358</td>\n",
       "      <td>0.003864</td>\n",
       "      <td>-0.004908</td>\n",
       "      <td>0.005996</td>\n",
       "      <td>-0.002718</td>\n",
       "      <td>-0.015044</td>\n",
       "      <td>0.018509</td>\n",
       "      <td>0.013697</td>\n",
       "      <td>-0.004540</td>\n",
       "      <td>-0.023163</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>company_size_10</th>\n",
       "      <td>-0.038806</td>\n",
       "      <td>0.074478</td>\n",
       "      <td>0.023639</td>\n",
       "      <td>-0.023778</td>\n",
       "      <td>-0.131353</td>\n",
       "      <td>-0.004688</td>\n",
       "      <td>0.008930</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>-0.073968</td>\n",
       "      <td>-0.093691</td>\n",
       "      <td>...</td>\n",
       "      <td>0.008254</td>\n",
       "      <td>-0.004103</td>\n",
       "      <td>-0.001075</td>\n",
       "      <td>0.005701</td>\n",
       "      <td>-0.003104</td>\n",
       "      <td>0.002646</td>\n",
       "      <td>-0.007206</td>\n",
       "      <td>-0.020094</td>\n",
       "      <td>0.007826</td>\n",
       "      <td>-0.044434</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>company_size_10-49</th>\n",
       "      <td>-0.049195</td>\n",
       "      <td>0.081345</td>\n",
       "      <td>0.011399</td>\n",
       "      <td>-0.057788</td>\n",
       "      <td>-0.069630</td>\n",
       "      <td>0.006068</td>\n",
       "      <td>-0.001774</td>\n",
       "      <td>-0.073968</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>-0.106133</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.010364</td>\n",
       "      <td>-0.016423</td>\n",
       "      <td>0.037204</td>\n",
       "      <td>0.049625</td>\n",
       "      <td>-0.026573</td>\n",
       "      <td>-0.026233</td>\n",
       "      <td>-0.011557</td>\n",
       "      <td>-0.003682</td>\n",
       "      <td>-0.027191</td>\n",
       "      <td>-0.015779</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>company_size_100-500</th>\n",
       "      <td>0.011144</td>\n",
       "      <td>0.138432</td>\n",
       "      <td>0.068999</td>\n",
       "      <td>0.059104</td>\n",
       "      <td>-0.009465</td>\n",
       "      <td>0.040375</td>\n",
       "      <td>-0.008305</td>\n",
       "      <td>-0.093691</td>\n",
       "      <td>-0.106133</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.022858</td>\n",
       "      <td>-0.011950</td>\n",
       "      <td>0.066691</td>\n",
       "      <td>0.003008</td>\n",
       "      <td>-0.053455</td>\n",
       "      <td>0.049841</td>\n",
       "      <td>-0.029053</td>\n",
       "      <td>0.005575</td>\n",
       "      <td>-0.023249</td>\n",
       "      <td>-0.099764</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>company_size_1000-4999</th>\n",
       "      <td>0.067984</td>\n",
       "      <td>0.071667</td>\n",
       "      <td>0.070527</td>\n",
       "      <td>0.095936</td>\n",
       "      <td>0.030883</td>\n",
       "      <td>0.092889</td>\n",
       "      <td>0.025332</td>\n",
       "      <td>-0.063800</td>\n",
       "      <td>-0.072272</td>\n",
       "      <td>-0.091543</td>\n",
       "      <td>...</td>\n",
       "      <td>0.009672</td>\n",
       "      <td>-0.002675</td>\n",
       "      <td>0.041214</td>\n",
       "      <td>0.000210</td>\n",
       "      <td>-0.051238</td>\n",
       "      <td>0.035552</td>\n",
       "      <td>-0.024255</td>\n",
       "      <td>0.042741</td>\n",
       "      <td>-0.015711</td>\n",
       "      <td>-0.067540</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>company_size_10000</th>\n",
       "      <td>0.026694</td>\n",
       "      <td>0.091211</td>\n",
       "      <td>0.075695</td>\n",
       "      <td>0.081463</td>\n",
       "      <td>0.130135</td>\n",
       "      <td>0.089602</td>\n",
       "      <td>-0.002443</td>\n",
       "      <td>-0.084417</td>\n",
       "      <td>-0.095628</td>\n",
       "      <td>-0.121127</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.017233</td>\n",
       "      <td>0.000320</td>\n",
       "      <td>0.092524</td>\n",
       "      <td>0.008639</td>\n",
       "      <td>-0.071133</td>\n",
       "      <td>0.057676</td>\n",
       "      <td>-0.046886</td>\n",
       "      <td>0.031583</td>\n",
       "      <td>-0.037297</td>\n",
       "      <td>-0.052432</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>company_size_50-99</th>\n",
       "      <td>-0.022533</td>\n",
       "      <td>0.173548</td>\n",
       "      <td>0.065008</td>\n",
       "      <td>-0.012415</td>\n",
       "      <td>-0.011939</td>\n",
       "      <td>0.023840</td>\n",
       "      <td>0.017645</td>\n",
       "      <td>-0.106055</td>\n",
       "      <td>-0.120139</td>\n",
       "      <td>-0.152174</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.000699</td>\n",
       "      <td>-0.004534</td>\n",
       "      <td>0.073192</td>\n",
       "      <td>0.021937</td>\n",
       "      <td>-0.048588</td>\n",
       "      <td>0.030079</td>\n",
       "      <td>-0.029553</td>\n",
       "      <td>-0.009394</td>\n",
       "      <td>-0.026151</td>\n",
       "      <td>-0.092468</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>company_size_500-999</th>\n",
       "      <td>0.001172</td>\n",
       "      <td>0.068112</td>\n",
       "      <td>0.034017</td>\n",
       "      <td>0.024650</td>\n",
       "      <td>0.009661</td>\n",
       "      <td>0.023946</td>\n",
       "      <td>-0.005627</td>\n",
       "      <td>-0.051185</td>\n",
       "      <td>-0.057982</td>\n",
       "      <td>-0.073442</td>\n",
       "      <td>...</td>\n",
       "      <td>0.000524</td>\n",
       "      <td>-0.008151</td>\n",
       "      <td>0.044882</td>\n",
       "      <td>0.033209</td>\n",
       "      <td>-0.042673</td>\n",
       "      <td>0.003650</td>\n",
       "      <td>-0.013625</td>\n",
       "      <td>-0.002495</td>\n",
       "      <td>-0.022614</td>\n",
       "      <td>-0.033432</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>company_size_5000-9999</th>\n",
       "      <td>0.026123</td>\n",
       "      <td>0.033054</td>\n",
       "      <td>0.037632</td>\n",
       "      <td>0.040701</td>\n",
       "      <td>0.014039</td>\n",
       "      <td>0.044820</td>\n",
       "      <td>0.011340</td>\n",
       "      <td>-0.042938</td>\n",
       "      <td>-0.048640</td>\n",
       "      <td>-0.061610</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.009815</td>\n",
       "      <td>-0.007854</td>\n",
       "      <td>0.033022</td>\n",
       "      <td>0.003816</td>\n",
       "      <td>-0.028005</td>\n",
       "      <td>0.013425</td>\n",
       "      <td>-0.019026</td>\n",
       "      <td>0.043414</td>\n",
       "      <td>-0.018971</td>\n",
       "      <td>-0.036997</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>company_size_Missing</th>\n",
       "      <td>-0.003308</td>\n",
       "      <td>-0.430778</td>\n",
       "      <td>-0.218906</td>\n",
       "      <td>-0.107079</td>\n",
       "      <td>0.014925</td>\n",
       "      <td>-0.170489</td>\n",
       "      <td>-0.023217</td>\n",
       "      <td>-0.197021</td>\n",
       "      <td>-0.223185</td>\n",
       "      <td>-0.282697</td>\n",
       "      <td>...</td>\n",
       "      <td>0.026442</td>\n",
       "      <td>0.029417</td>\n",
       "      <td>-0.224238</td>\n",
       "      <td>-0.068249</td>\n",
       "      <td>0.182697</td>\n",
       "      <td>-0.100955</td>\n",
       "      <td>0.103539</td>\n",
       "      <td>-0.038752</td>\n",
       "      <td>0.091849</td>\n",
       "      <td>0.256080</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>major_discipline_Arts</th>\n",
       "      <td>0.074646</td>\n",
       "      <td>0.019129</td>\n",
       "      <td>0.044966</td>\n",
       "      <td>0.012531</td>\n",
       "      <td>-0.014339</td>\n",
       "      <td>0.013346</td>\n",
       "      <td>-0.011559</td>\n",
       "      <td>0.006988</td>\n",
       "      <td>0.010257</td>\n",
       "      <td>0.007339</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.012828</td>\n",
       "      <td>-0.015548</td>\n",
       "      <td>-0.212326</td>\n",
       "      <td>0.036261</td>\n",
       "      <td>-0.037471</td>\n",
       "      <td>-0.004032</td>\n",
       "      <td>-0.017503</td>\n",
       "      <td>-0.005054</td>\n",
       "      <td>-0.012913</td>\n",
       "      <td>-0.022390</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>major_discipline_Business Degree</th>\n",
       "      <td>0.057682</td>\n",
       "      <td>-0.020863</td>\n",
       "      <td>0.055983</td>\n",
       "      <td>0.022144</td>\n",
       "      <td>0.024287</td>\n",
       "      <td>0.034732</td>\n",
       "      <td>0.032525</td>\n",
       "      <td>-0.008660</td>\n",
       "      <td>0.002650</td>\n",
       "      <td>-0.007328</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.015105</td>\n",
       "      <td>-0.018308</td>\n",
       "      <td>-0.250025</td>\n",
       "      <td>0.023371</td>\n",
       "      <td>-0.044124</td>\n",
       "      <td>0.022000</td>\n",
       "      <td>-0.020611</td>\n",
       "      <td>-0.018559</td>\n",
       "      <td>-0.015206</td>\n",
       "      <td>0.002914</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>major_discipline_Humanities</th>\n",
       "      <td>0.097511</td>\n",
       "      <td>-0.019207</td>\n",
       "      <td>0.063868</td>\n",
       "      <td>0.024154</td>\n",
       "      <td>-0.012676</td>\n",
       "      <td>0.057816</td>\n",
       "      <td>-0.019106</td>\n",
       "      <td>0.011133</td>\n",
       "      <td>-0.004125</td>\n",
       "      <td>-0.002037</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.019694</td>\n",
       "      <td>-0.023870</td>\n",
       "      <td>-0.325977</td>\n",
       "      <td>0.004698</td>\n",
       "      <td>-0.057528</td>\n",
       "      <td>0.047197</td>\n",
       "      <td>-0.026872</td>\n",
       "      <td>0.011283</td>\n",
       "      <td>-0.019825</td>\n",
       "      <td>-0.005831</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>major_discipline_Missing</th>\n",
       "      <td>0.011473</td>\n",
       "      <td>-0.290707</td>\n",
       "      <td>-0.166914</td>\n",
       "      <td>-0.182796</td>\n",
       "      <td>-0.009237</td>\n",
       "      <td>-0.176607</td>\n",
       "      <td>0.007331</td>\n",
       "      <td>-0.004283</td>\n",
       "      <td>-0.038197</td>\n",
       "      <td>-0.068259</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.044061</td>\n",
       "      <td>-0.053404</td>\n",
       "      <td>-0.729307</td>\n",
       "      <td>-0.509758</td>\n",
       "      <td>0.833916</td>\n",
       "      <td>-0.203362</td>\n",
       "      <td>0.389536</td>\n",
       "      <td>-0.054134</td>\n",
       "      <td>0.287377</td>\n",
       "      <td>-0.048418</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>major_discipline_No Major</th>\n",
       "      <td>0.029894</td>\n",
       "      <td>-0.012285</td>\n",
       "      <td>0.022021</td>\n",
       "      <td>0.009864</td>\n",
       "      <td>0.011643</td>\n",
       "      <td>0.008750</td>\n",
       "      <td>-0.006358</td>\n",
       "      <td>0.008254</td>\n",
       "      <td>-0.010364</td>\n",
       "      <td>-0.022858</td>\n",
       "      <td>...</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>-0.015246</td>\n",
       "      <td>-0.208203</td>\n",
       "      <td>0.061121</td>\n",
       "      <td>-0.036743</td>\n",
       "      <td>-0.030416</td>\n",
       "      <td>-0.017163</td>\n",
       "      <td>-0.015454</td>\n",
       "      <td>-0.012662</td>\n",
       "      <td>-0.000660</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>major_discipline_Other</th>\n",
       "      <td>-0.024654</td>\n",
       "      <td>-0.021716</td>\n",
       "      <td>0.021717</td>\n",
       "      <td>0.010833</td>\n",
       "      <td>0.001159</td>\n",
       "      <td>0.003484</td>\n",
       "      <td>0.003864</td>\n",
       "      <td>-0.004103</td>\n",
       "      <td>-0.016423</td>\n",
       "      <td>-0.011950</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.015246</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>-0.252351</td>\n",
       "      <td>0.032651</td>\n",
       "      <td>-0.044534</td>\n",
       "      <td>0.008632</td>\n",
       "      <td>-0.020803</td>\n",
       "      <td>-0.009675</td>\n",
       "      <td>-0.015347</td>\n",
       "      <td>0.017570</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>major_discipline_STEM</th>\n",
       "      <td>-0.087644</td>\n",
       "      <td>0.256437</td>\n",
       "      <td>0.067318</td>\n",
       "      <td>0.122664</td>\n",
       "      <td>0.005424</td>\n",
       "      <td>0.102320</td>\n",
       "      <td>-0.004908</td>\n",
       "      <td>-0.001075</td>\n",
       "      <td>0.037204</td>\n",
       "      <td>0.066691</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.208203</td>\n",
       "      <td>-0.252351</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.369739</td>\n",
       "      <td>-0.608181</td>\n",
       "      <td>0.145939</td>\n",
       "      <td>-0.284091</td>\n",
       "      <td>0.053962</td>\n",
       "      <td>-0.209586</td>\n",
       "      <td>0.041536</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>education_level_Graduate</th>\n",
       "      <td>-0.051108</td>\n",
       "      <td>0.105651</td>\n",
       "      <td>0.010652</td>\n",
       "      <td>-0.043459</td>\n",
       "      <td>0.049551</td>\n",
       "      <td>0.026675</td>\n",
       "      <td>0.005996</td>\n",
       "      <td>0.005701</td>\n",
       "      <td>0.049625</td>\n",
       "      <td>0.003008</td>\n",
       "      <td>...</td>\n",
       "      <td>0.061121</td>\n",
       "      <td>0.032651</td>\n",
       "      <td>0.369739</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>-0.429248</td>\n",
       "      <td>-0.689887</td>\n",
       "      <td>-0.200509</td>\n",
       "      <td>-0.180542</td>\n",
       "      <td>-0.147924</td>\n",
       "      <td>0.107522</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>education_level_High School</th>\n",
       "      <td>0.026704</td>\n",
       "      <td>-0.253505</td>\n",
       "      <td>-0.173130</td>\n",
       "      <td>-0.161722</td>\n",
       "      <td>-0.004740</td>\n",
       "      <td>-0.140453</td>\n",
       "      <td>-0.002718</td>\n",
       "      <td>-0.003104</td>\n",
       "      <td>-0.026573</td>\n",
       "      <td>-0.053455</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.036743</td>\n",
       "      <td>-0.044534</td>\n",
       "      <td>-0.608181</td>\n",
       "      <td>-0.429248</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>-0.172501</td>\n",
       "      <td>-0.050136</td>\n",
       "      <td>-0.045143</td>\n",
       "      <td>-0.036987</td>\n",
       "      <td>-0.051098</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>education_level_Masters</th>\n",
       "      <td>0.024830</td>\n",
       "      <td>0.124738</td>\n",
       "      <td>0.106172</td>\n",
       "      <td>0.156716</td>\n",
       "      <td>-0.020001</td>\n",
       "      <td>0.080912</td>\n",
       "      <td>-0.015044</td>\n",
       "      <td>0.002646</td>\n",
       "      <td>-0.026233</td>\n",
       "      <td>0.049841</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.030416</td>\n",
       "      <td>0.008632</td>\n",
       "      <td>0.145939</td>\n",
       "      <td>-0.689887</td>\n",
       "      <td>-0.172501</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>-0.080578</td>\n",
       "      <td>-0.072554</td>\n",
       "      <td>-0.059446</td>\n",
       "      <td>-0.062573</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>education_level_Missing</th>\n",
       "      <td>-0.035799</td>\n",
       "      <td>-0.069628</td>\n",
       "      <td>-0.044038</td>\n",
       "      <td>-0.041725</td>\n",
       "      <td>-0.010781</td>\n",
       "      <td>-0.056587</td>\n",
       "      <td>0.018509</td>\n",
       "      <td>-0.007206</td>\n",
       "      <td>-0.011557</td>\n",
       "      <td>-0.029053</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.017163</td>\n",
       "      <td>-0.020803</td>\n",
       "      <td>-0.284091</td>\n",
       "      <td>-0.200509</td>\n",
       "      <td>-0.050136</td>\n",
       "      <td>-0.080578</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>-0.021087</td>\n",
       "      <td>-0.017277</td>\n",
       "      <td>0.005658</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>education_level_Phd</th>\n",
       "      <td>0.074759</td>\n",
       "      <td>-0.029535</td>\n",
       "      <td>0.052448</td>\n",
       "      <td>0.134804</td>\n",
       "      <td>-0.092403</td>\n",
       "      <td>0.100850</td>\n",
       "      <td>0.013697</td>\n",
       "      <td>-0.020094</td>\n",
       "      <td>-0.003682</td>\n",
       "      <td>0.005575</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.015454</td>\n",
       "      <td>-0.009675</td>\n",
       "      <td>0.053962</td>\n",
       "      <td>-0.180542</td>\n",
       "      <td>-0.045143</td>\n",
       "      <td>-0.072554</td>\n",
       "      <td>-0.021087</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>-0.015557</td>\n",
       "      <td>-0.061248</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>education_level_Primary School</th>\n",
       "      <td>0.015749</td>\n",
       "      <td>-0.116343</td>\n",
       "      <td>0.016221</td>\n",
       "      <td>-0.069874</td>\n",
       "      <td>-0.001282</td>\n",
       "      <td>-0.088293</td>\n",
       "      <td>-0.004540</td>\n",
       "      <td>0.007826</td>\n",
       "      <td>-0.027191</td>\n",
       "      <td>-0.023249</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.012662</td>\n",
       "      <td>-0.015347</td>\n",
       "      <td>-0.209586</td>\n",
       "      <td>-0.147924</td>\n",
       "      <td>-0.036987</td>\n",
       "      <td>-0.059446</td>\n",
       "      <td>-0.017277</td>\n",
       "      <td>-0.015557</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>-0.031456</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>target</th>\n",
       "      <td>-0.362222</td>\n",
       "      <td>-0.148431</td>\n",
       "      <td>-0.142367</td>\n",
       "      <td>-0.211961</td>\n",
       "      <td>-0.000858</td>\n",
       "      <td>-0.093104</td>\n",
       "      <td>-0.023163</td>\n",
       "      <td>-0.044434</td>\n",
       "      <td>-0.015779</td>\n",
       "      <td>-0.099764</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.000660</td>\n",
       "      <td>0.017570</td>\n",
       "      <td>0.041536</td>\n",
       "      <td>0.107522</td>\n",
       "      <td>-0.051098</td>\n",
       "      <td>-0.062573</td>\n",
       "      <td>0.005658</td>\n",
       "      <td>-0.061248</td>\n",
       "      <td>-0.031456</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>30 rows × 30 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                  city_development_index  relevent_experience  \\\n",
       "city_development_index                          1.000000             0.038108   \n",
       "relevent_experience                             0.038108             1.000000   \n",
       "enrolled_university                             0.146105             0.333686   \n",
       "experience                                      0.373271             0.338362   \n",
       "company_type                                   -0.015940             0.069129   \n",
       "last_new_job                                    0.214989             0.251649   \n",
       "training_hours                                  0.012996             0.009706   \n",
       "company_size_10                                -0.038806             0.074478   \n",
       "company_size_10-49                             -0.049195             0.081345   \n",
       "company_size_100-500                            0.011144             0.138432   \n",
       "company_size_1000-4999                          0.067984             0.071667   \n",
       "company_size_10000                              0.026694             0.091211   \n",
       "company_size_50-99                             -0.022533             0.173548   \n",
       "company_size_500-999                            0.001172             0.068112   \n",
       "company_size_5000-9999                          0.026123             0.033054   \n",
       "company_size_Missing                           -0.003308            -0.430778   \n",
       "major_discipline_Arts                           0.074646             0.019129   \n",
       "major_discipline_Business Degree                0.057682            -0.020863   \n",
       "major_discipline_Humanities                     0.097511            -0.019207   \n",
       "major_discipline_Missing                        0.011473            -0.290707   \n",
       "major_discipline_No Major                       0.029894            -0.012285   \n",
       "major_discipline_Other                         -0.024654            -0.021716   \n",
       "major_discipline_STEM                          -0.087644             0.256437   \n",
       "education_level_Graduate                       -0.051108             0.105651   \n",
       "education_level_High School                     0.026704            -0.253505   \n",
       "education_level_Masters                         0.024830             0.124738   \n",
       "education_level_Missing                        -0.035799            -0.069628   \n",
       "education_level_Phd                             0.074759            -0.029535   \n",
       "education_level_Primary School                  0.015749            -0.116343   \n",
       "target                                         -0.362222            -0.148431   \n",
       "\n",
       "                                  enrolled_university  experience  \\\n",
       "city_development_index                       0.146105    0.373271   \n",
       "relevent_experience                          0.333686    0.338362   \n",
       "enrolled_university                          1.000000    0.332599   \n",
       "experience                                   0.332599    1.000000   \n",
       "company_type                                 0.061818    0.062327   \n",
       "last_new_job                                 0.229283    0.475912   \n",
       "training_hours                               0.010209    0.000709   \n",
       "company_size_10                              0.023639   -0.023778   \n",
       "company_size_10-49                           0.011399   -0.057788   \n",
       "company_size_100-500                         0.068999    0.059104   \n",
       "company_size_1000-4999                       0.070527    0.095936   \n",
       "company_size_10000                           0.075695    0.081463   \n",
       "company_size_50-99                           0.065008   -0.012415   \n",
       "company_size_500-999                         0.034017    0.024650   \n",
       "company_size_5000-9999                       0.037632    0.040701   \n",
       "company_size_Missing                        -0.218906   -0.107079   \n",
       "major_discipline_Arts                        0.044966    0.012531   \n",
       "major_discipline_Business Degree             0.055983    0.022144   \n",
       "major_discipline_Humanities                  0.063868    0.024154   \n",
       "major_discipline_Missing                    -0.166914   -0.182796   \n",
       "major_discipline_No Major                    0.022021    0.009864   \n",
       "major_discipline_Other                       0.021717    0.010833   \n",
       "major_discipline_STEM                        0.067318    0.122664   \n",
       "education_level_Graduate                     0.010652   -0.043459   \n",
       "education_level_High School                 -0.173130   -0.161722   \n",
       "education_level_Masters                      0.106172    0.156716   \n",
       "education_level_Missing                     -0.044038   -0.041725   \n",
       "education_level_Phd                          0.052448    0.134804   \n",
       "education_level_Primary School               0.016221   -0.069874   \n",
       "target                                      -0.142367   -0.211961   \n",
       "\n",
       "                                  company_type  last_new_job  training_hours  \\\n",
       "city_development_index               -0.015940      0.214989        0.012996   \n",
       "relevent_experience                   0.069129      0.251649        0.009706   \n",
       "enrolled_university                   0.061818      0.229283        0.010209   \n",
       "experience                            0.062327      0.475912        0.000709   \n",
       "company_type                          1.000000      0.065990        0.006223   \n",
       "last_new_job                          0.065990      1.000000        0.002625   \n",
       "training_hours                        0.006223      0.002625        1.000000   \n",
       "company_size_10                      -0.131353     -0.004688        0.008930   \n",
       "company_size_10-49                   -0.069630      0.006068       -0.001774   \n",
       "company_size_100-500                 -0.009465      0.040375       -0.008305   \n",
       "company_size_1000-4999                0.030883      0.092889        0.025332   \n",
       "company_size_10000                    0.130135      0.089602       -0.002443   \n",
       "company_size_50-99                   -0.011939      0.023840        0.017645   \n",
       "company_size_500-999                  0.009661      0.023946       -0.005627   \n",
       "company_size_5000-9999                0.014039      0.044820        0.011340   \n",
       "company_size_Missing                  0.014925     -0.170489       -0.023217   \n",
       "major_discipline_Arts                -0.014339      0.013346       -0.011559   \n",
       "major_discipline_Business Degree      0.024287      0.034732        0.032525   \n",
       "major_discipline_Humanities          -0.012676      0.057816       -0.019106   \n",
       "major_discipline_Missing             -0.009237     -0.176607        0.007331   \n",
       "major_discipline_No Major             0.011643      0.008750       -0.006358   \n",
       "major_discipline_Other                0.001159      0.003484        0.003864   \n",
       "major_discipline_STEM                 0.005424      0.102320       -0.004908   \n",
       "education_level_Graduate              0.049551      0.026675        0.005996   \n",
       "education_level_High School          -0.004740     -0.140453       -0.002718   \n",
       "education_level_Masters              -0.020001      0.080912       -0.015044   \n",
       "education_level_Missing              -0.010781     -0.056587        0.018509   \n",
       "education_level_Phd                  -0.092403      0.100850        0.013697   \n",
       "education_level_Primary School       -0.001282     -0.088293       -0.004540   \n",
       "target                               -0.000858     -0.093104       -0.023163   \n",
       "\n",
       "                                  company_size_10  company_size_10-49  \\\n",
       "city_development_index                  -0.038806           -0.049195   \n",
       "relevent_experience                      0.074478            0.081345   \n",
       "enrolled_university                      0.023639            0.011399   \n",
       "experience                              -0.023778           -0.057788   \n",
       "company_type                            -0.131353           -0.069630   \n",
       "last_new_job                            -0.004688            0.006068   \n",
       "training_hours                           0.008930           -0.001774   \n",
       "company_size_10                          1.000000           -0.073968   \n",
       "company_size_10-49                      -0.073968            1.000000   \n",
       "company_size_100-500                    -0.093691           -0.106133   \n",
       "company_size_1000-4999                  -0.063800           -0.072272   \n",
       "company_size_10000                      -0.084417           -0.095628   \n",
       "company_size_50-99                      -0.106055           -0.120139   \n",
       "company_size_500-999                    -0.051185           -0.057982   \n",
       "company_size_5000-9999                  -0.042938           -0.048640   \n",
       "company_size_Missing                    -0.197021           -0.223185   \n",
       "major_discipline_Arts                    0.006988            0.010257   \n",
       "major_discipline_Business Degree        -0.008660            0.002650   \n",
       "major_discipline_Humanities              0.011133           -0.004125   \n",
       "major_discipline_Missing                -0.004283           -0.038197   \n",
       "major_discipline_No Major                0.008254           -0.010364   \n",
       "major_discipline_Other                  -0.004103           -0.016423   \n",
       "major_discipline_STEM                   -0.001075            0.037204   \n",
       "education_level_Graduate                 0.005701            0.049625   \n",
       "education_level_High School             -0.003104           -0.026573   \n",
       "education_level_Masters                  0.002646           -0.026233   \n",
       "education_level_Missing                 -0.007206           -0.011557   \n",
       "education_level_Phd                     -0.020094           -0.003682   \n",
       "education_level_Primary School           0.007826           -0.027191   \n",
       "target                                  -0.044434           -0.015779   \n",
       "\n",
       "                                  company_size_100-500  ...  \\\n",
       "city_development_index                        0.011144  ...   \n",
       "relevent_experience                           0.138432  ...   \n",
       "enrolled_university                           0.068999  ...   \n",
       "experience                                    0.059104  ...   \n",
       "company_type                                 -0.009465  ...   \n",
       "last_new_job                                  0.040375  ...   \n",
       "training_hours                               -0.008305  ...   \n",
       "company_size_10                              -0.093691  ...   \n",
       "company_size_10-49                           -0.106133  ...   \n",
       "company_size_100-500                          1.000000  ...   \n",
       "company_size_1000-4999                       -0.091543  ...   \n",
       "company_size_10000                           -0.121127  ...   \n",
       "company_size_50-99                           -0.152174  ...   \n",
       "company_size_500-999                         -0.073442  ...   \n",
       "company_size_5000-9999                       -0.061610  ...   \n",
       "company_size_Missing                         -0.282697  ...   \n",
       "major_discipline_Arts                         0.007339  ...   \n",
       "major_discipline_Business Degree             -0.007328  ...   \n",
       "major_discipline_Humanities                  -0.002037  ...   \n",
       "major_discipline_Missing                     -0.068259  ...   \n",
       "major_discipline_No Major                    -0.022858  ...   \n",
       "major_discipline_Other                       -0.011950  ...   \n",
       "major_discipline_STEM                         0.066691  ...   \n",
       "education_level_Graduate                      0.003008  ...   \n",
       "education_level_High School                  -0.053455  ...   \n",
       "education_level_Masters                       0.049841  ...   \n",
       "education_level_Missing                      -0.029053  ...   \n",
       "education_level_Phd                           0.005575  ...   \n",
       "education_level_Primary School               -0.023249  ...   \n",
       "target                                       -0.099764  ...   \n",
       "\n",
       "                                  major_discipline_No Major  \\\n",
       "city_development_index                             0.029894   \n",
       "relevent_experience                               -0.012285   \n",
       "enrolled_university                                0.022021   \n",
       "experience                                         0.009864   \n",
       "company_type                                       0.011643   \n",
       "last_new_job                                       0.008750   \n",
       "training_hours                                    -0.006358   \n",
       "company_size_10                                    0.008254   \n",
       "company_size_10-49                                -0.010364   \n",
       "company_size_100-500                              -0.022858   \n",
       "company_size_1000-4999                             0.009672   \n",
       "company_size_10000                                -0.017233   \n",
       "company_size_50-99                                -0.000699   \n",
       "company_size_500-999                               0.000524   \n",
       "company_size_5000-9999                            -0.009815   \n",
       "company_size_Missing                               0.026442   \n",
       "major_discipline_Arts                             -0.012828   \n",
       "major_discipline_Business Degree                  -0.015105   \n",
       "major_discipline_Humanities                       -0.019694   \n",
       "major_discipline_Missing                          -0.044061   \n",
       "major_discipline_No Major                          1.000000   \n",
       "major_discipline_Other                            -0.015246   \n",
       "major_discipline_STEM                             -0.208203   \n",
       "education_level_Graduate                           0.061121   \n",
       "education_level_High School                       -0.036743   \n",
       "education_level_Masters                           -0.030416   \n",
       "education_level_Missing                           -0.017163   \n",
       "education_level_Phd                               -0.015454   \n",
       "education_level_Primary School                    -0.012662   \n",
       "target                                            -0.000660   \n",
       "\n",
       "                                  major_discipline_Other  \\\n",
       "city_development_index                         -0.024654   \n",
       "relevent_experience                            -0.021716   \n",
       "enrolled_university                             0.021717   \n",
       "experience                                      0.010833   \n",
       "company_type                                    0.001159   \n",
       "last_new_job                                    0.003484   \n",
       "training_hours                                  0.003864   \n",
       "company_size_10                                -0.004103   \n",
       "company_size_10-49                             -0.016423   \n",
       "company_size_100-500                           -0.011950   \n",
       "company_size_1000-4999                         -0.002675   \n",
       "company_size_10000                              0.000320   \n",
       "company_size_50-99                             -0.004534   \n",
       "company_size_500-999                           -0.008151   \n",
       "company_size_5000-9999                         -0.007854   \n",
       "company_size_Missing                            0.029417   \n",
       "major_discipline_Arts                          -0.015548   \n",
       "major_discipline_Business Degree               -0.018308   \n",
       "major_discipline_Humanities                    -0.023870   \n",
       "major_discipline_Missing                       -0.053404   \n",
       "major_discipline_No Major                      -0.015246   \n",
       "major_discipline_Other                          1.000000   \n",
       "major_discipline_STEM                          -0.252351   \n",
       "education_level_Graduate                        0.032651   \n",
       "education_level_High School                    -0.044534   \n",
       "education_level_Masters                         0.008632   \n",
       "education_level_Missing                        -0.020803   \n",
       "education_level_Phd                            -0.009675   \n",
       "education_level_Primary School                 -0.015347   \n",
       "target                                          0.017570   \n",
       "\n",
       "                                  major_discipline_STEM  \\\n",
       "city_development_index                        -0.087644   \n",
       "relevent_experience                            0.256437   \n",
       "enrolled_university                            0.067318   \n",
       "experience                                     0.122664   \n",
       "company_type                                   0.005424   \n",
       "last_new_job                                   0.102320   \n",
       "training_hours                                -0.004908   \n",
       "company_size_10                               -0.001075   \n",
       "company_size_10-49                             0.037204   \n",
       "company_size_100-500                           0.066691   \n",
       "company_size_1000-4999                         0.041214   \n",
       "company_size_10000                             0.092524   \n",
       "company_size_50-99                             0.073192   \n",
       "company_size_500-999                           0.044882   \n",
       "company_size_5000-9999                         0.033022   \n",
       "company_size_Missing                          -0.224238   \n",
       "major_discipline_Arts                         -0.212326   \n",
       "major_discipline_Business Degree              -0.250025   \n",
       "major_discipline_Humanities                   -0.325977   \n",
       "major_discipline_Missing                      -0.729307   \n",
       "major_discipline_No Major                     -0.208203   \n",
       "major_discipline_Other                        -0.252351   \n",
       "major_discipline_STEM                          1.000000   \n",
       "education_level_Graduate                       0.369739   \n",
       "education_level_High School                   -0.608181   \n",
       "education_level_Masters                        0.145939   \n",
       "education_level_Missing                       -0.284091   \n",
       "education_level_Phd                            0.053962   \n",
       "education_level_Primary School                -0.209586   \n",
       "target                                         0.041536   \n",
       "\n",
       "                                  education_level_Graduate  \\\n",
       "city_development_index                           -0.051108   \n",
       "relevent_experience                               0.105651   \n",
       "enrolled_university                               0.010652   \n",
       "experience                                       -0.043459   \n",
       "company_type                                      0.049551   \n",
       "last_new_job                                      0.026675   \n",
       "training_hours                                    0.005996   \n",
       "company_size_10                                   0.005701   \n",
       "company_size_10-49                                0.049625   \n",
       "company_size_100-500                              0.003008   \n",
       "company_size_1000-4999                            0.000210   \n",
       "company_size_10000                                0.008639   \n",
       "company_size_50-99                                0.021937   \n",
       "company_size_500-999                              0.033209   \n",
       "company_size_5000-9999                            0.003816   \n",
       "company_size_Missing                             -0.068249   \n",
       "major_discipline_Arts                             0.036261   \n",
       "major_discipline_Business Degree                  0.023371   \n",
       "major_discipline_Humanities                       0.004698   \n",
       "major_discipline_Missing                         -0.509758   \n",
       "major_discipline_No Major                         0.061121   \n",
       "major_discipline_Other                            0.032651   \n",
       "major_discipline_STEM                             0.369739   \n",
       "education_level_Graduate                          1.000000   \n",
       "education_level_High School                      -0.429248   \n",
       "education_level_Masters                          -0.689887   \n",
       "education_level_Missing                          -0.200509   \n",
       "education_level_Phd                              -0.180542   \n",
       "education_level_Primary School                   -0.147924   \n",
       "target                                            0.107522   \n",
       "\n",
       "                                  education_level_High School  \\\n",
       "city_development_index                               0.026704   \n",
       "relevent_experience                                 -0.253505   \n",
       "enrolled_university                                 -0.173130   \n",
       "experience                                          -0.161722   \n",
       "company_type                                        -0.004740   \n",
       "last_new_job                                        -0.140453   \n",
       "training_hours                                      -0.002718   \n",
       "company_size_10                                     -0.003104   \n",
       "company_size_10-49                                  -0.026573   \n",
       "company_size_100-500                                -0.053455   \n",
       "company_size_1000-4999                              -0.051238   \n",
       "company_size_10000                                  -0.071133   \n",
       "company_size_50-99                                  -0.048588   \n",
       "company_size_500-999                                -0.042673   \n",
       "company_size_5000-9999                              -0.028005   \n",
       "company_size_Missing                                 0.182697   \n",
       "major_discipline_Arts                               -0.037471   \n",
       "major_discipline_Business Degree                    -0.044124   \n",
       "major_discipline_Humanities                         -0.057528   \n",
       "major_discipline_Missing                             0.833916   \n",
       "major_discipline_No Major                           -0.036743   \n",
       "major_discipline_Other                              -0.044534   \n",
       "major_discipline_STEM                               -0.608181   \n",
       "education_level_Graduate                            -0.429248   \n",
       "education_level_High School                          1.000000   \n",
       "education_level_Masters                             -0.172501   \n",
       "education_level_Missing                             -0.050136   \n",
       "education_level_Phd                                 -0.045143   \n",
       "education_level_Primary School                      -0.036987   \n",
       "target                                              -0.051098   \n",
       "\n",
       "                                  education_level_Masters  \\\n",
       "city_development_index                           0.024830   \n",
       "relevent_experience                              0.124738   \n",
       "enrolled_university                              0.106172   \n",
       "experience                                       0.156716   \n",
       "company_type                                    -0.020001   \n",
       "last_new_job                                     0.080912   \n",
       "training_hours                                  -0.015044   \n",
       "company_size_10                                  0.002646   \n",
       "company_size_10-49                              -0.026233   \n",
       "company_size_100-500                             0.049841   \n",
       "company_size_1000-4999                           0.035552   \n",
       "company_size_10000                               0.057676   \n",
       "company_size_50-99                               0.030079   \n",
       "company_size_500-999                             0.003650   \n",
       "company_size_5000-9999                           0.013425   \n",
       "company_size_Missing                            -0.100955   \n",
       "major_discipline_Arts                           -0.004032   \n",
       "major_discipline_Business Degree                 0.022000   \n",
       "major_discipline_Humanities                      0.047197   \n",
       "major_discipline_Missing                        -0.203362   \n",
       "major_discipline_No Major                       -0.030416   \n",
       "major_discipline_Other                           0.008632   \n",
       "major_discipline_STEM                            0.145939   \n",
       "education_level_Graduate                        -0.689887   \n",
       "education_level_High School                     -0.172501   \n",
       "education_level_Masters                          1.000000   \n",
       "education_level_Missing                         -0.080578   \n",
       "education_level_Phd                             -0.072554   \n",
       "education_level_Primary School                  -0.059446   \n",
       "target                                          -0.062573   \n",
       "\n",
       "                                  education_level_Missing  \\\n",
       "city_development_index                          -0.035799   \n",
       "relevent_experience                             -0.069628   \n",
       "enrolled_university                             -0.044038   \n",
       "experience                                      -0.041725   \n",
       "company_type                                    -0.010781   \n",
       "last_new_job                                    -0.056587   \n",
       "training_hours                                   0.018509   \n",
       "company_size_10                                 -0.007206   \n",
       "company_size_10-49                              -0.011557   \n",
       "company_size_100-500                            -0.029053   \n",
       "company_size_1000-4999                          -0.024255   \n",
       "company_size_10000                              -0.046886   \n",
       "company_size_50-99                              -0.029553   \n",
       "company_size_500-999                            -0.013625   \n",
       "company_size_5000-9999                          -0.019026   \n",
       "company_size_Missing                             0.103539   \n",
       "major_discipline_Arts                           -0.017503   \n",
       "major_discipline_Business Degree                -0.020611   \n",
       "major_discipline_Humanities                     -0.026872   \n",
       "major_discipline_Missing                         0.389536   \n",
       "major_discipline_No Major                       -0.017163   \n",
       "major_discipline_Other                          -0.020803   \n",
       "major_discipline_STEM                           -0.284091   \n",
       "education_level_Graduate                        -0.200509   \n",
       "education_level_High School                     -0.050136   \n",
       "education_level_Masters                         -0.080578   \n",
       "education_level_Missing                          1.000000   \n",
       "education_level_Phd                             -0.021087   \n",
       "education_level_Primary School                  -0.017277   \n",
       "target                                           0.005658   \n",
       "\n",
       "                                  education_level_Phd  \\\n",
       "city_development_index                       0.074759   \n",
       "relevent_experience                         -0.029535   \n",
       "enrolled_university                          0.052448   \n",
       "experience                                   0.134804   \n",
       "company_type                                -0.092403   \n",
       "last_new_job                                 0.100850   \n",
       "training_hours                               0.013697   \n",
       "company_size_10                             -0.020094   \n",
       "company_size_10-49                          -0.003682   \n",
       "company_size_100-500                         0.005575   \n",
       "company_size_1000-4999                       0.042741   \n",
       "company_size_10000                           0.031583   \n",
       "company_size_50-99                          -0.009394   \n",
       "company_size_500-999                        -0.002495   \n",
       "company_size_5000-9999                       0.043414   \n",
       "company_size_Missing                        -0.038752   \n",
       "major_discipline_Arts                       -0.005054   \n",
       "major_discipline_Business Degree            -0.018559   \n",
       "major_discipline_Humanities                  0.011283   \n",
       "major_discipline_Missing                    -0.054134   \n",
       "major_discipline_No Major                   -0.015454   \n",
       "major_discipline_Other                      -0.009675   \n",
       "major_discipline_STEM                        0.053962   \n",
       "education_level_Graduate                    -0.180542   \n",
       "education_level_High School                 -0.045143   \n",
       "education_level_Masters                     -0.072554   \n",
       "education_level_Missing                     -0.021087   \n",
       "education_level_Phd                          1.000000   \n",
       "education_level_Primary School              -0.015557   \n",
       "target                                      -0.061248   \n",
       "\n",
       "                                  education_level_Primary School    target  \n",
       "city_development_index                                  0.015749 -0.362222  \n",
       "relevent_experience                                    -0.116343 -0.148431  \n",
       "enrolled_university                                     0.016221 -0.142367  \n",
       "experience                                             -0.069874 -0.211961  \n",
       "company_type                                           -0.001282 -0.000858  \n",
       "last_new_job                                           -0.088293 -0.093104  \n",
       "training_hours                                         -0.004540 -0.023163  \n",
       "company_size_10                                         0.007826 -0.044434  \n",
       "company_size_10-49                                     -0.027191 -0.015779  \n",
       "company_size_100-500                                   -0.023249 -0.099764  \n",
       "company_size_1000-4999                                 -0.015711 -0.067540  \n",
       "company_size_10000                                     -0.037297 -0.052432  \n",
       "company_size_50-99                                     -0.026151 -0.092468  \n",
       "company_size_500-999                                   -0.022614 -0.033432  \n",
       "company_size_5000-9999                                 -0.018971 -0.036997  \n",
       "company_size_Missing                                    0.091849  0.256080  \n",
       "major_discipline_Arts                                  -0.012913 -0.022390  \n",
       "major_discipline_Business Degree                       -0.015206  0.002914  \n",
       "major_discipline_Humanities                            -0.019825 -0.005831  \n",
       "major_discipline_Missing                                0.287377 -0.048418  \n",
       "major_discipline_No Major                              -0.012662 -0.000660  \n",
       "major_discipline_Other                                 -0.015347  0.017570  \n",
       "major_discipline_STEM                                  -0.209586  0.041536  \n",
       "education_level_Graduate                               -0.147924  0.107522  \n",
       "education_level_High School                            -0.036987 -0.051098  \n",
       "education_level_Masters                                -0.059446 -0.062573  \n",
       "education_level_Missing                                -0.017277  0.005658  \n",
       "education_level_Phd                                    -0.015557 -0.061248  \n",
       "education_level_Primary School                          1.000000 -0.031456  \n",
       "target                                                 -0.031456  1.000000  \n",
       "\n",
       "[30 rows x 30 columns]"
      ]
     },
     "execution_count": 182,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "prov=pd.concat([X_train,y_train], axis=1)\n",
    "prov.corr()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5cc78a0e-1505-4ed9-8a69-2cb13af79b66",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 183,
   "id": "961dd014-9228-47f0-b4de-1c2fa9cf716e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(6118, 29)"
      ]
     },
     "execution_count": 183,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X_train.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 184,
   "id": "0bb979f9-5eae-4fa6-94de-7b0958284fa1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>city_development_index</th>\n",
       "      <th>relevent_experience</th>\n",
       "      <th>enrolled_university</th>\n",
       "      <th>experience</th>\n",
       "      <th>company_type</th>\n",
       "      <th>last_new_job</th>\n",
       "      <th>training_hours</th>\n",
       "      <th>company_size_10</th>\n",
       "      <th>company_size_10-49</th>\n",
       "      <th>company_size_100-500</th>\n",
       "      <th>...</th>\n",
       "      <th>major_discipline_Missing</th>\n",
       "      <th>major_discipline_No Major</th>\n",
       "      <th>major_discipline_Other</th>\n",
       "      <th>major_discipline_STEM</th>\n",
       "      <th>education_level_Graduate</th>\n",
       "      <th>education_level_High School</th>\n",
       "      <th>education_level_Masters</th>\n",
       "      <th>education_level_Missing</th>\n",
       "      <th>education_level_Phd</th>\n",
       "      <th>education_level_Primary School</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1513</th>\n",
       "      <td>0.754</td>\n",
       "      <td>0.695162</td>\n",
       "      <td>0.684864</td>\n",
       "      <td>21.0</td>\n",
       "      <td>0.030239</td>\n",
       "      <td>5.0</td>\n",
       "      <td>46</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>216</th>\n",
       "      <td>0.920</td>\n",
       "      <td>0.695162</td>\n",
       "      <td>0.684864</td>\n",
       "      <td>21.0</td>\n",
       "      <td>0.376757</td>\n",
       "      <td>5.0</td>\n",
       "      <td>56</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4391</th>\n",
       "      <td>0.624</td>\n",
       "      <td>0.304838</td>\n",
       "      <td>0.230141</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.376757</td>\n",
       "      <td>0.0</td>\n",
       "      <td>91</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6118</th>\n",
       "      <td>0.555</td>\n",
       "      <td>0.695162</td>\n",
       "      <td>0.684864</td>\n",
       "      <td>6.0</td>\n",
       "      <td>0.470742</td>\n",
       "      <td>5.0</td>\n",
       "      <td>55</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>421</th>\n",
       "      <td>0.624</td>\n",
       "      <td>0.695162</td>\n",
       "      <td>0.230141</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.470742</td>\n",
       "      <td>1.0</td>\n",
       "      <td>50</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 29 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      city_development_index  relevent_experience  enrolled_university  \\\n",
       "1513                   0.754             0.695162             0.684864   \n",
       "216                    0.920             0.695162             0.684864   \n",
       "4391                   0.624             0.304838             0.230141   \n",
       "6118                   0.555             0.695162             0.684864   \n",
       "421                    0.624             0.695162             0.230141   \n",
       "\n",
       "      experience  company_type  last_new_job  training_hours  company_size_10  \\\n",
       "1513        21.0      0.030239           5.0              46              1.0   \n",
       "216         21.0      0.376757           5.0              56              0.0   \n",
       "4391         5.0      0.376757           0.0              91              0.0   \n",
       "6118         6.0      0.470742           5.0              55              0.0   \n",
       "421          5.0      0.470742           1.0              50              0.0   \n",
       "\n",
       "      company_size_10-49  company_size_100-500  ...  major_discipline_Missing  \\\n",
       "1513                 0.0                   0.0  ...                       0.0   \n",
       "216                  0.0                   0.0  ...                       1.0   \n",
       "4391                 0.0                   0.0  ...                       1.0   \n",
       "6118                 0.0                   0.0  ...                       0.0   \n",
       "421                  0.0                   0.0  ...                       0.0   \n",
       "\n",
       "      major_discipline_No Major  major_discipline_Other  \\\n",
       "1513                        0.0                     0.0   \n",
       "216                         0.0                     0.0   \n",
       "4391                        0.0                     0.0   \n",
       "6118                        0.0                     0.0   \n",
       "421                         0.0                     0.0   \n",
       "\n",
       "      major_discipline_STEM  education_level_Graduate  \\\n",
       "1513                    1.0                       0.0   \n",
       "216                     0.0                       0.0   \n",
       "4391                    0.0                       0.0   \n",
       "6118                    1.0                       1.0   \n",
       "421                     1.0                       1.0   \n",
       "\n",
       "      education_level_High School  education_level_Masters  \\\n",
       "1513                          0.0                      1.0   \n",
       "216                           0.0                      0.0   \n",
       "4391                          1.0                      0.0   \n",
       "6118                          0.0                      0.0   \n",
       "421                           0.0                      0.0   \n",
       "\n",
       "      education_level_Missing  education_level_Phd  \\\n",
       "1513                      0.0                  0.0   \n",
       "216                       1.0                  0.0   \n",
       "4391                      0.0                  0.0   \n",
       "6118                      0.0                  0.0   \n",
       "421                       0.0                  0.0   \n",
       "\n",
       "      education_level_Primary School  \n",
       "1513                             0.0  \n",
       "216                              0.0  \n",
       "4391                             0.0  \n",
       "6118                             0.0  \n",
       "421                              0.0  \n",
       "\n",
       "[5 rows x 29 columns]"
      ]
     },
     "execution_count": 184,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X_train.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 185,
   "id": "7bc77667-88e1-4600-b31b-62151097c89b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(1530, 29)"
      ]
     },
     "execution_count": 185,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X_test.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 186,
   "id": "1873754f-5766-4d01-98b6-319a0d6a8062",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn import svm\n",
    "from sklearn.svm import LinearSVC"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 191,
   "id": "b98a07d8-871e-46ef-9d99-d5d02a76f525",
   "metadata": {},
   "outputs": [],
   "source": [
    "job_pipeline = Pipeline([#('scaler', RobustScaler()),\n",
    "                        ('model', RandomForestClassifier(n_estimators=700, max_depth = 10))], verbose = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 192,
   "id": "62b6bc89-ed55-425c-9244-bc5ae0d91f21",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[Pipeline] ............. (step 1 of 1) Processing model, total=   4.2s\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<style>#sk-container-id-6 {color: black;background-color: white;}#sk-container-id-6 pre{padding: 0;}#sk-container-id-6 div.sk-toggleable {background-color: white;}#sk-container-id-6 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-6 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-6 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-6 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-6 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-6 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-6 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-6 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-6 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-6 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-6 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-6 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-6 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-6 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-6 div.sk-item {position: relative;z-index: 1;}#sk-container-id-6 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-6 div.sk-item::before, #sk-container-id-6 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-6 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-6 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-6 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-6 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-6 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-6 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-6 div.sk-label-container {text-align: center;}#sk-container-id-6 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-6 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-6\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>Pipeline(steps=[(&#x27;model&#x27;,\n",
       "                 RandomForestClassifier(max_depth=10, n_estimators=700))],\n",
       "         verbose=True)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-11\" type=\"checkbox\" ><label for=\"sk-estimator-id-11\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">Pipeline</label><div class=\"sk-toggleable__content\"><pre>Pipeline(steps=[(&#x27;model&#x27;,\n",
       "                 RandomForestClassifier(max_depth=10, n_estimators=700))],\n",
       "         verbose=True)</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-12\" type=\"checkbox\" ><label for=\"sk-estimator-id-12\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">RandomForestClassifier</label><div class=\"sk-toggleable__content\"><pre>RandomForestClassifier(max_depth=10, n_estimators=700)</pre></div></div></div></div></div></div></div>"
      ],
      "text/plain": [
       "Pipeline(steps=[('model',\n",
       "                 RandomForestClassifier(max_depth=10, n_estimators=700))],\n",
       "         verbose=True)"
      ]
     },
     "execution_count": 192,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "job_pipeline.fit(X_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 193,
   "id": "f7cacb9c-c10f-4f4f-a770-158435a81b8d",
   "metadata": {},
   "outputs": [],
   "source": [
    "X_train_pred = job_pipeline.predict(X_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 194,
   "id": "f29f73a1-4203-4a51-8c63-1a0878d9fcf3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.80385746976136"
      ]
     },
     "execution_count": 194,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "job_pipeline.score(X_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 195,
   "id": "2bdee9e3-b961-4a81-8b0a-327f9a3f387a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.7640522875816993"
      ]
     },
     "execution_count": 195,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "job_pipeline.score(X_test, y_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "2902c56c-1d91-4c1f-be17-dc53ee3971e0",
   "metadata": {},
   "outputs": [],
   "source": [
    "### AHORA CONVERTIR TODO EL DF TEST PARA SACAR LOS RESULTADOS"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 130,
   "id": "138219e5-55a1-468e-8ef9-977ba464ba95",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_test_original = pd.read_csv('../z_test.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 131,
   "id": "7df2f2f9-359a-4614-9854-beed934b7704",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(3832, 13)"
      ]
     },
     "execution_count": 131,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_test= df_test_original.copy()\n",
    "df_test.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 132,
   "id": "577465d3-7490-4fa9-a192-7b6fab93df83",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>enrollee_id</th>\n",
       "      <th>city</th>\n",
       "      <th>city_development_index</th>\n",
       "      <th>gender</th>\n",
       "      <th>relevent_experience</th>\n",
       "      <th>enrolled_university</th>\n",
       "      <th>education_level</th>\n",
       "      <th>major_discipline</th>\n",
       "      <th>experience</th>\n",
       "      <th>company_size</th>\n",
       "      <th>company_type</th>\n",
       "      <th>last_new_job</th>\n",
       "      <th>training_hours</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>23603</td>\n",
       "      <td>city_160</td>\n",
       "      <td>0.920</td>\n",
       "      <td>Male</td>\n",
       "      <td>No relevent experience</td>\n",
       "      <td>Full time course</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>STEM</td>\n",
       "      <td>5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>78</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>22499</td>\n",
       "      <td>city_45</td>\n",
       "      <td>0.890</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Has relevent experience</td>\n",
       "      <td>Full time course</td>\n",
       "      <td>High School</td>\n",
       "      <td>NaN</td>\n",
       "      <td>6</td>\n",
       "      <td>50-99</td>\n",
       "      <td>Pvt Ltd</td>\n",
       "      <td>1</td>\n",
       "      <td>36</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>10465</td>\n",
       "      <td>city_149</td>\n",
       "      <td>0.689</td>\n",
       "      <td>Male</td>\n",
       "      <td>No relevent experience</td>\n",
       "      <td>no_enrollment</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>STEM</td>\n",
       "      <td>5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>never</td>\n",
       "      <td>34</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>8293</td>\n",
       "      <td>city_67</td>\n",
       "      <td>0.855</td>\n",
       "      <td>Female</td>\n",
       "      <td>Has relevent experience</td>\n",
       "      <td>no_enrollment</td>\n",
       "      <td>Masters</td>\n",
       "      <td>STEM</td>\n",
       "      <td>9</td>\n",
       "      <td>1000-4999</td>\n",
       "      <td>Pvt Ltd</td>\n",
       "      <td>1</td>\n",
       "      <td>149</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4246</td>\n",
       "      <td>city_103</td>\n",
       "      <td>0.920</td>\n",
       "      <td>Male</td>\n",
       "      <td>Has relevent experience</td>\n",
       "      <td>no_enrollment</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>STEM</td>\n",
       "      <td>16</td>\n",
       "      <td>50-99</td>\n",
       "      <td>Funded Startup</td>\n",
       "      <td>2</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   enrollee_id      city  city_development_index  gender  \\\n",
       "0        23603  city_160                   0.920    Male   \n",
       "1        22499   city_45                   0.890     NaN   \n",
       "2        10465  city_149                   0.689    Male   \n",
       "3         8293   city_67                   0.855  Female   \n",
       "4         4246  city_103                   0.920    Male   \n",
       "\n",
       "       relevent_experience enrolled_university education_level  \\\n",
       "0   No relevent experience    Full time course        Graduate   \n",
       "1  Has relevent experience    Full time course     High School   \n",
       "2   No relevent experience       no_enrollment        Graduate   \n",
       "3  Has relevent experience       no_enrollment         Masters   \n",
       "4  Has relevent experience       no_enrollment        Graduate   \n",
       "\n",
       "  major_discipline experience company_size    company_type last_new_job  \\\n",
       "0             STEM          5          NaN             NaN            1   \n",
       "1              NaN          6        50-99         Pvt Ltd            1   \n",
       "2             STEM          5          NaN             NaN        never   \n",
       "3             STEM          9    1000-4999         Pvt Ltd            1   \n",
       "4             STEM         16        50-99  Funded Startup            2   \n",
       "\n",
       "   training_hours  \n",
       "0              78  \n",
       "1              36  \n",
       "2              34  \n",
       "3             149  \n",
       "4               7  "
      ]
     },
     "execution_count": 132,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_test.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 133,
   "id": "2ae2316f-a348-4b02-9b89-a626ba3c8700",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 3832 entries, 0 to 3831\n",
      "Data columns (total 13 columns):\n",
      " #   Column                  Non-Null Count  Dtype  \n",
      "---  ------                  --------------  -----  \n",
      " 0   enrollee_id             3832 non-null   int64  \n",
      " 1   city                    3832 non-null   object \n",
      " 2   city_development_index  3832 non-null   float64\n",
      " 3   gender                  2925 non-null   object \n",
      " 4   relevent_experience     3832 non-null   object \n",
      " 5   enrolled_university     3748 non-null   object \n",
      " 6   education_level         3741 non-null   object \n",
      " 7   major_discipline        3256 non-null   object \n",
      " 8   experience              3817 non-null   object \n",
      " 9   company_size            2628 non-null   object \n",
      " 10  company_type            2583 non-null   object \n",
      " 11  last_new_job            3748 non-null   object \n",
      " 12  training_hours          3832 non-null   int64  \n",
      "dtypes: float64(1), int64(2), object(10)\n",
      "memory usage: 389.3+ KB\n"
     ]
    }
   ],
   "source": [
    "df_test.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 134,
   "id": "65055bff-63c8-4ef8-b062-589db020c0d0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "enrollee_id                  0\n",
       "city                         0\n",
       "city_development_index       0\n",
       "relevent_experience          0\n",
       "training_hours               0\n",
       "experience                  15\n",
       "enrolled_university         84\n",
       "last_new_job                84\n",
       "education_level             91\n",
       "major_discipline           576\n",
       "gender                     907\n",
       "company_size              1204\n",
       "company_type              1249\n",
       "dtype: int64"
      ]
     },
     "execution_count": 134,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_test.isna().sum().sort_values()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 135,
   "id": "bccba189-bec4-4a2c-af86-1b8c7d93b8eb",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_test.experience.replace('>20','21', inplace=True)\n",
    "df_test.experience.replace('<1','0', inplace=True)\n",
    "df_test.experience= pd.to_numeric(df_test.experience)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 136,
   "id": "e9194182-297a-497f-bdc1-24e57d4623b4",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_test.last_new_job.replace('>4','5', inplace=True)\n",
    "df_test.last_new_job.replace('never','0', inplace=True)\n",
    "df_test.last_new_job= pd.to_numeric(df_test.last_new_job)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 137,
   "id": "de7923b2-a28e-439a-b616-bd5de9682021",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "50-99        635\n",
       "100-500      512\n",
       "10000+       366\n",
       "10/49        298\n",
       "<10          265\n",
       "1000-4999    262\n",
       "500-999      170\n",
       "5000-9999    120\n",
       "Name: company_size, dtype: int64"
      ]
     },
     "execution_count": 137,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_test.company_size.value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 138,
   "id": "cb64928e-29fe-4ce4-b6ff-b1dc21ee83ed",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "50-99        635\n",
       "100-500      512\n",
       "10000+       366\n",
       "10/49        298\n",
       "<10          265\n",
       "1000-4999    262\n",
       "500-999      170\n",
       "5000-9999    120\n",
       "Name: company_size, dtype: int64"
      ]
     },
     "execution_count": 138,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_test.company_size.value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 139,
   "id": "bbe62329-4469-4c1d-9da5-44e90206d2fc",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_test.company_size.replace('10000+','10000', inplace=True)\n",
    "df_test.company_size.replace('10/49','10-49', inplace=True)\n",
    "df_test.company_size.replace('<10','10', inplace=True)\n",
    "df_test.company_size.replace('50-99','50-99', inplace=True)\n",
    "df_test.company_size.replace('1000-4999','1000-4999', inplace=True)\n",
    "df_test.company_size.replace('500-999','500-999', inplace=True)\n",
    "df_test.company_size.replace('5000-9999','5000-9999', inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 140,
   "id": "a5d56229-6611-4945-8ecd-345fb0fb60e8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "50-99        635\n",
       "100-500      512\n",
       "10000        366\n",
       "10-49        298\n",
       "10           265\n",
       "1000-4999    262\n",
       "500-999      170\n",
       "5000-9999    120\n",
       "Name: company_size, dtype: int64"
      ]
     },
     "execution_count": 140,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_test.company_size.value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 141,
   "id": "14d8dc55-04fe-4610-b5fe-8371dc4ca156",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0             NaN\n",
       "1           50-99\n",
       "2             NaN\n",
       "3       1000-4999\n",
       "4           50-99\n",
       "          ...    \n",
       "3827          NaN\n",
       "3828        50-99\n",
       "3829        50-99\n",
       "3830          NaN\n",
       "3831        10-49\n",
       "Name: company_size, Length: 3832, dtype: object"
      ]
     },
     "execution_count": 141,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_test['company_size']=df_test['company_size'].astype('object')\n",
    "df_test['company_size']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 142,
   "id": "961af6ce-f4b9-4075-b090-286c87414b07",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "enrollee_id                  0\n",
       "city                         0\n",
       "city_development_index       0\n",
       "relevent_experience          0\n",
       "training_hours               0\n",
       "experience                  15\n",
       "enrolled_university         84\n",
       "last_new_job                84\n",
       "education_level             91\n",
       "major_discipline           576\n",
       "gender                     907\n",
       "company_size              1204\n",
       "company_type              1249\n",
       "dtype: int64"
      ]
     },
     "execution_count": 142,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_test.isna().sum().sort_values()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 143,
   "id": "bb27fc17-2b6b-4d43-9dae-abafd04bcc2b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 3832 entries, 0 to 3831\n",
      "Data columns (total 13 columns):\n",
      " #   Column                  Non-Null Count  Dtype  \n",
      "---  ------                  --------------  -----  \n",
      " 0   enrollee_id             3832 non-null   int64  \n",
      " 1   city                    3832 non-null   object \n",
      " 2   city_development_index  3832 non-null   float64\n",
      " 3   gender                  2925 non-null   object \n",
      " 4   relevent_experience     3832 non-null   object \n",
      " 5   enrolled_university     3748 non-null   object \n",
      " 6   education_level         3741 non-null   object \n",
      " 7   major_discipline        3256 non-null   object \n",
      " 8   experience              3817 non-null   float64\n",
      " 9   company_size            2628 non-null   object \n",
      " 10  company_type            2583 non-null   object \n",
      " 11  last_new_job            3748 non-null   float64\n",
      " 12  training_hours          3832 non-null   int64  \n",
      "dtypes: float64(3), int64(2), object(8)\n",
      "memory usage: 389.3+ KB\n"
     ]
    }
   ],
   "source": [
    "df_test.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 144,
   "id": "d048dd64-142c-4a13-9713-547da28a7c21",
   "metadata": {},
   "outputs": [],
   "source": [
    "impmiss = mdi.CategoricalImputer('missing', variables = ['enrolled_university', 'education_level','major_discipline', 'company_size', 'gender', 'company_type'])\n",
    "df_test = impmiss.fit_transform(df_test)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 145,
   "id": "bdc01bde-a2f3-45b6-b0f9-3c768672e1ad",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "enrollee_id                0\n",
       "city                       0\n",
       "city_development_index     0\n",
       "gender                     0\n",
       "relevent_experience        0\n",
       "enrolled_university        0\n",
       "education_level            0\n",
       "major_discipline           0\n",
       "company_size               0\n",
       "company_type               0\n",
       "training_hours             0\n",
       "experience                15\n",
       "last_new_job              84\n",
       "dtype: int64"
      ]
     },
     "execution_count": 145,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_test.isna().sum().sort_values()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 146,
   "id": "872943e2-597f-4336-90c0-cf6ecb9e669c",
   "metadata": {},
   "outputs": [],
   "source": [
    "impmean= mdi.MeanMedianImputer(imputation_method='median', variables=['experience','last_new_job'])\n",
    "df_test = impmean.fit_transform(df_test) "
   ]
  },
  {
   "cell_type": "raw",
   "id": "581f9597-1223-4110-882c-0f2c7fcc2285",
   "metadata": {},
   "source": [
    "label_enc = preprocessing.LabelEncoder()"
   ]
  },
  {
   "cell_type": "raw",
   "id": "a48b2c14-a82b-4511-b40a-7bc749c57249",
   "metadata": {},
   "source": [
    "df_test_codif = label_enc.fit_transform(df_test['relevent_experience'])"
   ]
  },
  {
   "cell_type": "raw",
   "id": "3bc2d229-2c02-40e9-9081-294513b85223",
   "metadata": {},
   "source": [
    "pd.DataFrame({\n",
    "    \"original\": df_test['relevent_experience'][:6],\n",
    "    \"codificada\": df_test_codif [:6]\n",
    "})"
   ]
  },
  {
   "cell_type": "raw",
   "id": "ebbabb0f-3c8b-44e3-b326-c379c1487aeb",
   "metadata": {},
   "source": [
    "df_test['relevent_experience']=label_enc.fit_transform(df_test['relevent_experience'])"
   ]
  },
  {
   "cell_type": "raw",
   "id": "e31748b7-d682-4f1e-8f76-1bdb4f11b314",
   "metadata": {},
   "source": [
    "df_test.isna().sum().sort_values()"
   ]
  },
  {
   "cell_type": "raw",
   "id": "049ed80a-ed17-4c1e-8a17-2e57ca79845d",
   "metadata": {},
   "source": [
    "df_test.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 147,
   "id": "1f3ecdee-5a4b-4be1-beb5-d9653c87e485",
   "metadata": {},
   "outputs": [],
   "source": [
    "onehot = OneHotEncoder( handle_unknown='ignore', sparse = False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 148,
   "id": "f0e5cb4c-75ea-46aa-8617-7c3d9d8cfa44",
   "metadata": {},
   "outputs": [],
   "source": [
    "data_onehot= onehot.fit_transform(df_test[['company_size', 'major_discipline', 'education_level']])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 149,
   "id": "8c850a78-49a6-43fd-82fd-5c76fcaf954e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>enrollee_id</th>\n",
       "      <th>city</th>\n",
       "      <th>city_development_index</th>\n",
       "      <th>gender</th>\n",
       "      <th>relevent_experience</th>\n",
       "      <th>enrolled_university</th>\n",
       "      <th>education_level</th>\n",
       "      <th>major_discipline</th>\n",
       "      <th>experience</th>\n",
       "      <th>company_size</th>\n",
       "      <th>...</th>\n",
       "      <th>major_discipline_Missing</th>\n",
       "      <th>major_discipline_No Major</th>\n",
       "      <th>major_discipline_Other</th>\n",
       "      <th>major_discipline_STEM</th>\n",
       "      <th>education_level_Graduate</th>\n",
       "      <th>education_level_High School</th>\n",
       "      <th>education_level_Masters</th>\n",
       "      <th>education_level_Missing</th>\n",
       "      <th>education_level_Phd</th>\n",
       "      <th>education_level_Primary School</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>23603</td>\n",
       "      <td>city_160</td>\n",
       "      <td>0.920</td>\n",
       "      <td>Male</td>\n",
       "      <td>No relevent experience</td>\n",
       "      <td>Full time course</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>STEM</td>\n",
       "      <td>5.0</td>\n",
       "      <td>Missing</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>22499</td>\n",
       "      <td>city_45</td>\n",
       "      <td>0.890</td>\n",
       "      <td>Missing</td>\n",
       "      <td>Has relevent experience</td>\n",
       "      <td>Full time course</td>\n",
       "      <td>High School</td>\n",
       "      <td>Missing</td>\n",
       "      <td>6.0</td>\n",
       "      <td>50-99</td>\n",
       "      <td>...</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>10465</td>\n",
       "      <td>city_149</td>\n",
       "      <td>0.689</td>\n",
       "      <td>Male</td>\n",
       "      <td>No relevent experience</td>\n",
       "      <td>no_enrollment</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>STEM</td>\n",
       "      <td>5.0</td>\n",
       "      <td>Missing</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>8293</td>\n",
       "      <td>city_67</td>\n",
       "      <td>0.855</td>\n",
       "      <td>Female</td>\n",
       "      <td>Has relevent experience</td>\n",
       "      <td>no_enrollment</td>\n",
       "      <td>Masters</td>\n",
       "      <td>STEM</td>\n",
       "      <td>9.0</td>\n",
       "      <td>1000-4999</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4246</td>\n",
       "      <td>city_103</td>\n",
       "      <td>0.920</td>\n",
       "      <td>Male</td>\n",
       "      <td>Has relevent experience</td>\n",
       "      <td>no_enrollment</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>STEM</td>\n",
       "      <td>16.0</td>\n",
       "      <td>50-99</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 35 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   enrollee_id      city  city_development_index   gender  \\\n",
       "0        23603  city_160                   0.920     Male   \n",
       "1        22499   city_45                   0.890  Missing   \n",
       "2        10465  city_149                   0.689     Male   \n",
       "3         8293   city_67                   0.855   Female   \n",
       "4         4246  city_103                   0.920     Male   \n",
       "\n",
       "       relevent_experience enrolled_university education_level  \\\n",
       "0   No relevent experience    Full time course        Graduate   \n",
       "1  Has relevent experience    Full time course     High School   \n",
       "2   No relevent experience       no_enrollment        Graduate   \n",
       "3  Has relevent experience       no_enrollment         Masters   \n",
       "4  Has relevent experience       no_enrollment        Graduate   \n",
       "\n",
       "  major_discipline  experience company_size  ... major_discipline_Missing  \\\n",
       "0             STEM         5.0      Missing  ...                      0.0   \n",
       "1          Missing         6.0        50-99  ...                      1.0   \n",
       "2             STEM         5.0      Missing  ...                      0.0   \n",
       "3             STEM         9.0    1000-4999  ...                      0.0   \n",
       "4             STEM        16.0        50-99  ...                      0.0   \n",
       "\n",
       "   major_discipline_No Major  major_discipline_Other  major_discipline_STEM  \\\n",
       "0                        0.0                     0.0                    1.0   \n",
       "1                        0.0                     0.0                    0.0   \n",
       "2                        0.0                     0.0                    1.0   \n",
       "3                        0.0                     0.0                    1.0   \n",
       "4                        0.0                     0.0                    1.0   \n",
       "\n",
       "   education_level_Graduate  education_level_High School  \\\n",
       "0                       1.0                          0.0   \n",
       "1                       0.0                          1.0   \n",
       "2                       1.0                          0.0   \n",
       "3                       0.0                          0.0   \n",
       "4                       1.0                          0.0   \n",
       "\n",
       "   education_level_Masters  education_level_Missing  education_level_Phd  \\\n",
       "0                      0.0                      0.0                  0.0   \n",
       "1                      0.0                      0.0                  0.0   \n",
       "2                      0.0                      0.0                  0.0   \n",
       "3                      1.0                      0.0                  0.0   \n",
       "4                      0.0                      0.0                  0.0   \n",
       "\n",
       "   education_level_Primary School  \n",
       "0                             0.0  \n",
       "1                             0.0  \n",
       "2                             0.0  \n",
       "3                             0.0  \n",
       "4                             0.0  \n",
       "\n",
       "[5 rows x 35 columns]"
      ]
     },
     "execution_count": 149,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_test[onehot.get_feature_names_out()] = data_onehot\n",
    "df_test.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 150,
   "id": "2739e47d-df1c-43a3-9bb2-ec46b40faa94",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>enrollee_id</th>\n",
       "      <th>city</th>\n",
       "      <th>city_development_index</th>\n",
       "      <th>gender</th>\n",
       "      <th>relevent_experience</th>\n",
       "      <th>enrolled_university</th>\n",
       "      <th>education_level</th>\n",
       "      <th>major_discipline</th>\n",
       "      <th>experience</th>\n",
       "      <th>company_size</th>\n",
       "      <th>...</th>\n",
       "      <th>major_discipline_Missing</th>\n",
       "      <th>major_discipline_No Major</th>\n",
       "      <th>major_discipline_Other</th>\n",
       "      <th>major_discipline_STEM</th>\n",
       "      <th>education_level_Graduate</th>\n",
       "      <th>education_level_High School</th>\n",
       "      <th>education_level_Masters</th>\n",
       "      <th>education_level_Missing</th>\n",
       "      <th>education_level_Phd</th>\n",
       "      <th>education_level_Primary School</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>23603</td>\n",
       "      <td>city_160</td>\n",
       "      <td>0.920</td>\n",
       "      <td>Male</td>\n",
       "      <td>No relevent experience</td>\n",
       "      <td>Full time course</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>STEM</td>\n",
       "      <td>5.0</td>\n",
       "      <td>Missing</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>22499</td>\n",
       "      <td>city_45</td>\n",
       "      <td>0.890</td>\n",
       "      <td>Missing</td>\n",
       "      <td>Has relevent experience</td>\n",
       "      <td>Full time course</td>\n",
       "      <td>High School</td>\n",
       "      <td>Missing</td>\n",
       "      <td>6.0</td>\n",
       "      <td>50-99</td>\n",
       "      <td>...</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>10465</td>\n",
       "      <td>city_149</td>\n",
       "      <td>0.689</td>\n",
       "      <td>Male</td>\n",
       "      <td>No relevent experience</td>\n",
       "      <td>no_enrollment</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>STEM</td>\n",
       "      <td>5.0</td>\n",
       "      <td>Missing</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>8293</td>\n",
       "      <td>city_67</td>\n",
       "      <td>0.855</td>\n",
       "      <td>Female</td>\n",
       "      <td>Has relevent experience</td>\n",
       "      <td>no_enrollment</td>\n",
       "      <td>Masters</td>\n",
       "      <td>STEM</td>\n",
       "      <td>9.0</td>\n",
       "      <td>1000-4999</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4246</td>\n",
       "      <td>city_103</td>\n",
       "      <td>0.920</td>\n",
       "      <td>Male</td>\n",
       "      <td>Has relevent experience</td>\n",
       "      <td>no_enrollment</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>STEM</td>\n",
       "      <td>16.0</td>\n",
       "      <td>50-99</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 35 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   enrollee_id      city  city_development_index   gender  \\\n",
       "0        23603  city_160                   0.920     Male   \n",
       "1        22499   city_45                   0.890  Missing   \n",
       "2        10465  city_149                   0.689     Male   \n",
       "3         8293   city_67                   0.855   Female   \n",
       "4         4246  city_103                   0.920     Male   \n",
       "\n",
       "       relevent_experience enrolled_university education_level  \\\n",
       "0   No relevent experience    Full time course        Graduate   \n",
       "1  Has relevent experience    Full time course     High School   \n",
       "2   No relevent experience       no_enrollment        Graduate   \n",
       "3  Has relevent experience       no_enrollment         Masters   \n",
       "4  Has relevent experience       no_enrollment        Graduate   \n",
       "\n",
       "  major_discipline  experience company_size  ... major_discipline_Missing  \\\n",
       "0             STEM         5.0      Missing  ...                      0.0   \n",
       "1          Missing         6.0        50-99  ...                      1.0   \n",
       "2             STEM         5.0      Missing  ...                      0.0   \n",
       "3             STEM         9.0    1000-4999  ...                      0.0   \n",
       "4             STEM        16.0        50-99  ...                      0.0   \n",
       "\n",
       "   major_discipline_No Major  major_discipline_Other  major_discipline_STEM  \\\n",
       "0                        0.0                     0.0                    1.0   \n",
       "1                        0.0                     0.0                    0.0   \n",
       "2                        0.0                     0.0                    1.0   \n",
       "3                        0.0                     0.0                    1.0   \n",
       "4                        0.0                     0.0                    1.0   \n",
       "\n",
       "   education_level_Graduate  education_level_High School  \\\n",
       "0                       1.0                          0.0   \n",
       "1                       0.0                          1.0   \n",
       "2                       1.0                          0.0   \n",
       "3                       0.0                          0.0   \n",
       "4                       1.0                          0.0   \n",
       "\n",
       "   education_level_Masters  education_level_Missing  education_level_Phd  \\\n",
       "0                      0.0                      0.0                  0.0   \n",
       "1                      0.0                      0.0                  0.0   \n",
       "2                      0.0                      0.0                  0.0   \n",
       "3                      1.0                      0.0                  0.0   \n",
       "4                      0.0                      0.0                  0.0   \n",
       "\n",
       "   education_level_Primary School  \n",
       "0                             0.0  \n",
       "1                             0.0  \n",
       "2                             0.0  \n",
       "3                             0.0  \n",
       "4                             0.0  \n",
       "\n",
       "[5 rows x 35 columns]"
      ]
     },
     "execution_count": 150,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_test[onehot.get_feature_names_out()] = data_onehot\n",
    "df_test.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 151,
   "id": "b4b0a802-241c-418d-bfb2-191c8ddb4a3f",
   "metadata": {},
   "outputs": [],
   "source": [
    "freq_enc = CountFrequencyEncoder(encoding_method='frequency', variables=[ 'enrolled_university', 'gender','relevent_experience', 'company_type'])\n",
    "df_test = freq_enc.fit_transform(df_test.dropna())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 152,
   "id": "67b2aa93-bef9-4608-918c-4df195415360",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>enrollee_id</th>\n",
       "      <th>city</th>\n",
       "      <th>city_development_index</th>\n",
       "      <th>gender</th>\n",
       "      <th>relevent_experience</th>\n",
       "      <th>enrolled_university</th>\n",
       "      <th>education_level</th>\n",
       "      <th>major_discipline</th>\n",
       "      <th>experience</th>\n",
       "      <th>company_size</th>\n",
       "      <th>...</th>\n",
       "      <th>major_discipline_Missing</th>\n",
       "      <th>major_discipline_No Major</th>\n",
       "      <th>major_discipline_Other</th>\n",
       "      <th>major_discipline_STEM</th>\n",
       "      <th>education_level_Graduate</th>\n",
       "      <th>education_level_High School</th>\n",
       "      <th>education_level_Masters</th>\n",
       "      <th>education_level_Missing</th>\n",
       "      <th>education_level_Phd</th>\n",
       "      <th>education_level_Primary School</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>23603</td>\n",
       "      <td>city_160</td>\n",
       "      <td>0.920</td>\n",
       "      <td>0.689979</td>\n",
       "      <td>0.289144</td>\n",
       "      <td>0.200157</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>STEM</td>\n",
       "      <td>5.0</td>\n",
       "      <td>Missing</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>22499</td>\n",
       "      <td>city_45</td>\n",
       "      <td>0.890</td>\n",
       "      <td>0.236691</td>\n",
       "      <td>0.710856</td>\n",
       "      <td>0.200157</td>\n",
       "      <td>High School</td>\n",
       "      <td>Missing</td>\n",
       "      <td>6.0</td>\n",
       "      <td>50-99</td>\n",
       "      <td>...</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>10465</td>\n",
       "      <td>city_149</td>\n",
       "      <td>0.689</td>\n",
       "      <td>0.689979</td>\n",
       "      <td>0.289144</td>\n",
       "      <td>0.716597</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>STEM</td>\n",
       "      <td>5.0</td>\n",
       "      <td>Missing</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>8293</td>\n",
       "      <td>city_67</td>\n",
       "      <td>0.855</td>\n",
       "      <td>0.062630</td>\n",
       "      <td>0.710856</td>\n",
       "      <td>0.716597</td>\n",
       "      <td>Masters</td>\n",
       "      <td>STEM</td>\n",
       "      <td>9.0</td>\n",
       "      <td>1000-4999</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4246</td>\n",
       "      <td>city_103</td>\n",
       "      <td>0.920</td>\n",
       "      <td>0.689979</td>\n",
       "      <td>0.710856</td>\n",
       "      <td>0.716597</td>\n",
       "      <td>Graduate</td>\n",
       "      <td>STEM</td>\n",
       "      <td>16.0</td>\n",
       "      <td>50-99</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 35 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   enrollee_id      city  city_development_index    gender  \\\n",
       "0        23603  city_160                   0.920  0.689979   \n",
       "1        22499   city_45                   0.890  0.236691   \n",
       "2        10465  city_149                   0.689  0.689979   \n",
       "3         8293   city_67                   0.855  0.062630   \n",
       "4         4246  city_103                   0.920  0.689979   \n",
       "\n",
       "   relevent_experience  enrolled_university education_level major_discipline  \\\n",
       "0             0.289144             0.200157        Graduate             STEM   \n",
       "1             0.710856             0.200157     High School          Missing   \n",
       "2             0.289144             0.716597        Graduate             STEM   \n",
       "3             0.710856             0.716597         Masters             STEM   \n",
       "4             0.710856             0.716597        Graduate             STEM   \n",
       "\n",
       "   experience company_size  ...  major_discipline_Missing  \\\n",
       "0         5.0      Missing  ...                       0.0   \n",
       "1         6.0        50-99  ...                       1.0   \n",
       "2         5.0      Missing  ...                       0.0   \n",
       "3         9.0    1000-4999  ...                       0.0   \n",
       "4        16.0        50-99  ...                       0.0   \n",
       "\n",
       "   major_discipline_No Major  major_discipline_Other  major_discipline_STEM  \\\n",
       "0                        0.0                     0.0                    1.0   \n",
       "1                        0.0                     0.0                    0.0   \n",
       "2                        0.0                     0.0                    1.0   \n",
       "3                        0.0                     0.0                    1.0   \n",
       "4                        0.0                     0.0                    1.0   \n",
       "\n",
       "   education_level_Graduate  education_level_High School  \\\n",
       "0                       1.0                          0.0   \n",
       "1                       0.0                          1.0   \n",
       "2                       1.0                          0.0   \n",
       "3                       0.0                          0.0   \n",
       "4                       1.0                          0.0   \n",
       "\n",
       "   education_level_Masters  education_level_Missing  education_level_Phd  \\\n",
       "0                      0.0                      0.0                  0.0   \n",
       "1                      0.0                      0.0                  0.0   \n",
       "2                      0.0                      0.0                  0.0   \n",
       "3                      1.0                      0.0                  0.0   \n",
       "4                      0.0                      0.0                  0.0   \n",
       "\n",
       "   education_level_Primary School  \n",
       "0                             0.0  \n",
       "1                             0.0  \n",
       "2                             0.0  \n",
       "3                             0.0  \n",
       "4                             0.0  \n",
       "\n",
       "[5 rows x 35 columns]"
      ]
     },
     "execution_count": 152,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_test.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 153,
   "id": "ca49d966-b8c4-404d-aa56-2dc2e6782976",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_test.drop(['city','major_discipline','company_size', 'education_level' ], axis=1, inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 154,
   "id": "4338829f-572b-4e9e-8a11-240e67c82f22",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_test.drop(['enrollee_id'], axis=1, inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 155,
   "id": "dc208436-19ca-4db9-a7d3-722cdc19d89c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(3832, 30)"
      ]
     },
     "execution_count": 155,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_test.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 156,
   "id": "9ac45622-73ce-471a-8aca-e1747a8fda33",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>city_development_index</th>\n",
       "      <th>gender</th>\n",
       "      <th>relevent_experience</th>\n",
       "      <th>enrolled_university</th>\n",
       "      <th>experience</th>\n",
       "      <th>company_type</th>\n",
       "      <th>last_new_job</th>\n",
       "      <th>training_hours</th>\n",
       "      <th>company_size_10</th>\n",
       "      <th>company_size_10-49</th>\n",
       "      <th>...</th>\n",
       "      <th>major_discipline_Missing</th>\n",
       "      <th>major_discipline_No Major</th>\n",
       "      <th>major_discipline_Other</th>\n",
       "      <th>major_discipline_STEM</th>\n",
       "      <th>education_level_Graduate</th>\n",
       "      <th>education_level_High School</th>\n",
       "      <th>education_level_Masters</th>\n",
       "      <th>education_level_Missing</th>\n",
       "      <th>education_level_Phd</th>\n",
       "      <th>education_level_Primary School</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0.920</td>\n",
       "      <td>0.689979</td>\n",
       "      <td>0.289144</td>\n",
       "      <td>0.200157</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.325939</td>\n",
       "      <td>1.0</td>\n",
       "      <td>78</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0.890</td>\n",
       "      <td>0.236691</td>\n",
       "      <td>0.710856</td>\n",
       "      <td>0.200157</td>\n",
       "      <td>6.0</td>\n",
       "      <td>0.507307</td>\n",
       "      <td>1.0</td>\n",
       "      <td>36</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0.689</td>\n",
       "      <td>0.689979</td>\n",
       "      <td>0.289144</td>\n",
       "      <td>0.716597</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.325939</td>\n",
       "      <td>0.0</td>\n",
       "      <td>34</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0.855</td>\n",
       "      <td>0.062630</td>\n",
       "      <td>0.710856</td>\n",
       "      <td>0.716597</td>\n",
       "      <td>9.0</td>\n",
       "      <td>0.507307</td>\n",
       "      <td>1.0</td>\n",
       "      <td>149</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0.920</td>\n",
       "      <td>0.689979</td>\n",
       "      <td>0.710856</td>\n",
       "      <td>0.716597</td>\n",
       "      <td>16.0</td>\n",
       "      <td>0.054541</td>\n",
       "      <td>2.0</td>\n",
       "      <td>7</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 30 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   city_development_index    gender  relevent_experience  enrolled_university  \\\n",
       "0                   0.920  0.689979             0.289144             0.200157   \n",
       "1                   0.890  0.236691             0.710856             0.200157   \n",
       "2                   0.689  0.689979             0.289144             0.716597   \n",
       "3                   0.855  0.062630             0.710856             0.716597   \n",
       "4                   0.920  0.689979             0.710856             0.716597   \n",
       "\n",
       "   experience  company_type  last_new_job  training_hours  company_size_10  \\\n",
       "0         5.0      0.325939           1.0              78              0.0   \n",
       "1         6.0      0.507307           1.0              36              0.0   \n",
       "2         5.0      0.325939           0.0              34              0.0   \n",
       "3         9.0      0.507307           1.0             149              0.0   \n",
       "4        16.0      0.054541           2.0               7              0.0   \n",
       "\n",
       "   company_size_10-49  ...  major_discipline_Missing  \\\n",
       "0                 0.0  ...                       0.0   \n",
       "1                 0.0  ...                       1.0   \n",
       "2                 0.0  ...                       0.0   \n",
       "3                 0.0  ...                       0.0   \n",
       "4                 0.0  ...                       0.0   \n",
       "\n",
       "   major_discipline_No Major  major_discipline_Other  major_discipline_STEM  \\\n",
       "0                        0.0                     0.0                    1.0   \n",
       "1                        0.0                     0.0                    0.0   \n",
       "2                        0.0                     0.0                    1.0   \n",
       "3                        0.0                     0.0                    1.0   \n",
       "4                        0.0                     0.0                    1.0   \n",
       "\n",
       "   education_level_Graduate  education_level_High School  \\\n",
       "0                       1.0                          0.0   \n",
       "1                       0.0                          1.0   \n",
       "2                       1.0                          0.0   \n",
       "3                       0.0                          0.0   \n",
       "4                       1.0                          0.0   \n",
       "\n",
       "   education_level_Masters  education_level_Missing  education_level_Phd  \\\n",
       "0                      0.0                      0.0                  0.0   \n",
       "1                      0.0                      0.0                  0.0   \n",
       "2                      0.0                      0.0                  0.0   \n",
       "3                      1.0                      0.0                  0.0   \n",
       "4                      0.0                      0.0                  0.0   \n",
       "\n",
       "   education_level_Primary School  \n",
       "0                             0.0  \n",
       "1                             0.0  \n",
       "2                             0.0  \n",
       "3                             0.0  \n",
       "4                             0.0  \n",
       "\n",
       "[5 rows x 30 columns]"
      ]
     },
     "execution_count": 156,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_test.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 157,
   "id": "fb390a61-5b62-4ca1-9dc9-151ea3eb6126",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([1, 0, 1, ..., 0, 0, 0])"
      ]
     },
     "execution_count": 157,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "prediccionest= job_pipeline.predict(df_test)\n",
    "prediccionest"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 158,
   "id": "25022b0b-9ca8-4c4d-96fe-15e8bc00bba4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[0.22688118, 0.77311882],\n",
       "       [0.75413623, 0.24586377],\n",
       "       [0.23382071, 0.76617929],\n",
       "       ...,\n",
       "       [0.69250273, 0.30749727],\n",
       "       [0.62185988, 0.37814012],\n",
       "       [0.7658425 , 0.2341575 ]])"
      ]
     },
     "execution_count": 158,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "predicciones= job_pipeline.predict_proba(df_test)\n",
    "predicciones"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 159,
   "id": "c0ca5fed-1ec2-44c0-901d-fbef23b7f191",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>enrollee_id</th>\n",
       "      <th>target</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>23603</td>\n",
       "      <td>0.773119</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>22499</td>\n",
       "      <td>0.245864</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>10465</td>\n",
       "      <td>0.766179</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>8293</td>\n",
       "      <td>0.287788</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4246</td>\n",
       "      <td>0.230314</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3827</th>\n",
       "      <td>8880</td>\n",
       "      <td>0.778815</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3828</th>\n",
       "      <td>7886</td>\n",
       "      <td>0.232325</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3829</th>\n",
       "      <td>12279</td>\n",
       "      <td>0.307497</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3830</th>\n",
       "      <td>5326</td>\n",
       "      <td>0.378140</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3831</th>\n",
       "      <td>4017</td>\n",
       "      <td>0.234157</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3832 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      enrollee_id    target\n",
       "0           23603  0.773119\n",
       "1           22499  0.245864\n",
       "2           10465  0.766179\n",
       "3            8293  0.287788\n",
       "4            4246  0.230314\n",
       "...           ...       ...\n",
       "3827         8880  0.778815\n",
       "3828         7886  0.232325\n",
       "3829        12279  0.307497\n",
       "3830         5326  0.378140\n",
       "3831         4017  0.234157\n",
       "\n",
       "[3832 rows x 2 columns]"
      ]
     },
     "execution_count": 159,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "submission = pd.DataFrame({'enrollee_id':df_test_original ['enrollee_id'], \"target\": predicciones[:,1]})\n",
    "submission"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 160,
   "id": "7691406c-8edf-4dba-ae4e-4348eb52a186",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>enrollee_id</th>\n",
       "      <th>target</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>23603</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>22499</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>10465</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>8293</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4246</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3827</th>\n",
       "      <td>8880</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3828</th>\n",
       "      <td>7886</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3829</th>\n",
       "      <td>12279</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3830</th>\n",
       "      <td>5326</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3831</th>\n",
       "      <td>4017</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3832 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      enrollee_id  target\n",
       "0           23603       1\n",
       "1           22499       0\n",
       "2           10465       1\n",
       "3            8293       0\n",
       "4            4246       0\n",
       "...           ...     ...\n",
       "3827         8880       1\n",
       "3828         7886       0\n",
       "3829        12279       0\n",
       "3830         5326       0\n",
       "3831         4017       0\n",
       "\n",
       "[3832 rows x 2 columns]"
      ]
     },
     "execution_count": 160,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "submissionNO = pd.DataFrame({'enrollee_id':df_test_original ['enrollee_id'], \"target\": prediccionest})\n",
    "submissionNO"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 161,
   "id": "b61f5c81-74b8-49df-a500-f79054413267",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    2428\n",
       "1    1404\n",
       "Name: target, dtype: int64"
      ]
     },
     "execution_count": 161,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "submissionNO.target.value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 162,
   "id": "b963c9ba-358b-4d0f-ad0d-07e7d78747f0",
   "metadata": {},
   "outputs": [],
   "source": [
    "submission.to_csv(\"submission30082022.csv\", index=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4bb5a5cb-a5f0-4684-b04e-6a5225dff29e",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0366f7a7-59c6-4ce5-b131-d4ace3d2f411",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5a7157b8-c58e-4c12-be78-9acd1f210ec8",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
